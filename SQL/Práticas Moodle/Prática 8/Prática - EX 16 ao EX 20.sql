-- Grupo PK
SET SEARCH_PATH TO banco;
-- 16) CONSULTAS USANDO AGRUPAMENTOS SIMPLES
    --> Em todas as questões as respostas devem ser sem repetições. Em muitos casos o DISTINCT resolveria
        -- a questão, mas para as questões abaixo não use o DISTINCT.
	-- (a) Listar todos os estados que possuem agências.
SELECT estado FROM agencia GROUP BY estado ORDER BY estado;
/*
"MG"
"MS"
"RJ"
"RO"
"RS"
"SC"
"SP"
"TO"
*/
	-- (b) Listar todos os tipos de operações que existem.
SELECT tipo from operacao GROUP BY tipo ORDER BY tipo;
/*
"1"
"2"
"3"
"c"
"C"
"d"
"D"
"s"
"S"
"T"
*/
	-- (c) Listar todos os CPFs de clientes. Comparar o tamanho da resposta com o número de clientes e justificar.
SELECT * FROM cliente; --193 clientes
SELECT cpf FROM cliente GROUP BY cpf; --193 cpfs
-- Tirevam a mesma quantidade de linhas pois o CPF não se repete em nenhum cliente
/*
"05362772902"
"12345678957"
"12345678925"
"29087694920"
"33739746904"
"20579635842"
"03199033970"
"12345678953"
"55734755842"
"89917571035"
"06335200988"
"12345678952"
"12345678959"
"00792737938"
"29577233953"
"27800866610"
"02725651999"
"07069859406"
"69780496114"
"12345678927"
"04706362970"
"03585695235"
"06041324922"
"03846532940"
"08991927777"
"04448066959"
"12345678950"
"48752703053"
"06650278939"
"23939997833"
"85396036915"
"93090394006"
"04369835917"
"01854777980"
"44599512397"
"12345678919"
"12345678917"
"80183783042"
"05850348930"
"00483754978"
"04908484945"
"05700395924"
"68055758000"
"05367539971"
"04669206958"
"05572563994"
"99897738735"
"04832707922"
"04821578956"
"12345678941"
"01541771990"
"80078358906"
"12345678944"
"05545845909"
"20358425120"
"06462560924"
"12345678920"
"89180090460"
"12345678958"
"21896358420"
"14176777915"
"35305410959"
"12345678930"
"03503396942"
"12345678940"
"12345678914"
"12345678911"
"12345678923"
"05879924920"
"06068223990"
"32112354397"
"00782528066"
"02256619931"
"03424042960"
"43390845810"
"12345678921"
"05441620994"
"04791470940"
"04061328956"
"12345678948"
"12345678936"
"04557798993"
"69387268683"
"16581815730"
"12345678913"
"00646419960"
"04764612941"
"12345678926"
"12345678956"
"04811057945"
"12345678954"
"00935847928"
"70573760900"
"38104193970"
"03655964935"
"87329143421"
"68898220995"
"98151129450"
"12345678933"
"12345678912"
"92366236972"
"67982921949"
"73405243041"
"57069343710"
"12345678935"
"12345678924"
"05584583944"
"83885099004"
"12345678931"
"46852670600"
"00991591984"
"54816360930"
"03235925970"
"56641324427"
"00667008098"
"77768035968"
"52516341610"
"53042891968"
"05099207995"
"12345678955"
"07274654900"
"12345678949"
"12345678915"
"85117398408"
"41626708037"
"07303071903"
"02684397961"
"30860954072"
"06954374962"
"12345678934"
"04325317937"
"04588506919"
"29984302016"
"06616573966"
"05469950980"
"95026959920"
"10399599157"
"23283531692"
"00755634950"
"12345678937"
"05951323916"
"07765605909"
"12345678929"
"12345678951"
"28839881964"
"04239344905"
"03978509997"
"01953352952"
"09299878960"
"12345678932"
"06126726979"
"01985066947"
"12345678946"
"05159721932"
"12345678943"
"12345678918"
"07084631933"
"05227932905"
"12345678945"
"04778738985"
"12345678942"
"03276618958"
"22386426920"
"06439009931"
"12345678916"
"82840059053"
"53467736068"
"01983609919"
"01226243002"
"03088055933"
"00045847916"
"04788758946"
"81309368520"
"06635721932"
"12345678960"
"98109758053"
"00486693937"
"86053589047"
"12345678922"
"06318824995"
"12345678939"
"04136509952"
"12345678928"
"05250008950"
"94832480600"
"05647675905"
"12345678938"
"12345678947"
"04910596984"
"25612054235"
"39311481068"
"03132341916"
"22267918412"
*/

	-- (d) Listar todos os estados e municípios que possuem agências.
SELECT estado,municipio from agencia GROUP BY estado,municipio ORDER BY estado,municipio;
/*
"MG";"Belo Horizonte"
"MG";"Juiz de Fora"
"MG";"Uberlândia"
"MS";"Amamba"
"MS";"Anaurilandia"
"MS";"Angelica"
"MS";"Aparecida do Taboado"
"MS";"Aquidauana"
"RJ";"RIO DE JANEIRO"
"RJ";"TERESOPOLIS"
"RO";"Porto Velho"
"RS";"Passo Fundo"
"RS";"Porto Alegre"
"RS";"Santa Maria"
"SC";"blumenau"
"SP";"Bebedouro"
"SP";"Itapira"
"SP";"Mirandopolis"
"SP";"Ribeirão Bonito"
"SP";"SAO PAULO"
"SP";"Sertãozinho"
"TO";"Araguaina"
"TO";"Bernardo Sayao"
"TO";"Gurupi"
"TO";"Palmas"
*/
	-- (e) Listar todas as datas de nascimento, cidade e estado dos clientes
SELECT data_nasc,cidade,estado FROM cliente GROUP BY data_nasc,cidade,estado; --existem clientes que nasceram no mesmo dia e moram no mesmo lugar
/*
"1990-04-27";"Porto Alegre";"Rs"
"2000-01-01";"Rio de Janeiro";"RG"
"1956-03-18";"Uberlândia";"MG"
"1987-08-19";"Porto Alegre";"Rs"
"1993-08-27";"Porto Alegre";"Rs"
"1995-02-20";"Uberlandia";"MG"
"1994-05-14";"Santa Maria";"Rs"
"1982-05-16";"Santa Maria";"Rs"
"1982-04-27";"SAO PAULO";"SP"
"1985-02-07";"Santa Maria";"Rs"
"1990-06-21";"Sao Paulo";"SP"
"1983-07-29";"SAO PAULO";"SP"
"1983-03-06";"Porto Alegre";"Rs"
"1991-09-04";"Santa Maria";"Rs"
"1985-06-03";"SAO PAULO";"SP"
"1974-05-08";"Guarapari";"ES"
"1989-12-06";"Passo Fundo";"Rs"
"1989-03-23";"Blumenau";"SC"
"1986-08-05";"SAO PAULO";"SP"
"1987-04-12";"Araguaina";"TO"
"1992-02-02";"Porto Velho";"RO"
"1983-09-24";"SAO PAULO";"SP"
"1984-10-31";"Porto Alegre";"Rs"
"1989-12-16";"Santa Maria";"Rs"
"1991-02-03";"Sao Paulo";"SP"
"1940-10-12";"Uberlândia";"MG"
"1992-06-26";"Campos Lindos";"TO"
"1995-05-05";"Porto Velho";"RO"
"1988-11-04";"Porto Alegre";"Rs"
"1991-07-07";"Porto Alegre";"Rs"
"1980-01-11";"Porto Alegre";"Rs"
"1994-01-10";"Santa Maria";"Rs"
"1991-03-03";"Blumenau";"SC"
"1948-08-02";"Uberlandia";"MG"
"1981-05-04";"Passo Fundo";"Rs"
"1997-12-16";"Porto Alegre";"Rs"
"1990-12-01";"Augustinopolis";"TO"
"1987-07-17";"Porto Alegre";"Rs"
"1983-02-13";"Porto Alegre";"Rs"
"1986-01-08";"SAO PAULO";"SP"
"1990-03-18";"Santa Maria";"Rs"
"1964-01-12";"Blumenau";"SC"
"1987-07-28";"Santa Maria";"Rs"
"1989-02-28";"Mateiros";"TO"
"1985-02-25";"SAO PAULO";"SP"
"1979-01-31";"Axixa do Tocantins";"TO"
"1982-12-28";"SAO PAULO";"SP"
"1985-04-22";"SAO PAULO";"SP"
"1982-11-12";"Bebedouro";"SP"
"1981-05-23";"Passo Fundo";"Rs"
"1990-03-03";"Porto Alegre";"Rs"
"1983-12-11";"Santa Maria";"Rs"
"1981-06-27";"SAO PAULO";"SP"
"1975-06-07";"Porto Alegre";"Rs"
"1983-02-07";"SAO PAULO";"SP"
"1981-07-21";"SAO PAULO";"SP"
"1984-04-18";"SAO PAULO";"SP"
"1990-01-10";"São Paulo";"SP"
"1987-12-28";"Cariri do Tocantins";"TO"
"1991-01-01";"Porto Velho";"RO"
"1990-06-29";"Gurupi";"TO"
"1994-04-04";"Porto Velho";"RO"
"1981-06-03";"SAO PAULO";"SP"
"1986-05-24";"SAO PAULO";"SP"
"1980-10-29";"Colinas do Tocantins";"TO"
"1991-03-27";"Passo Fundo";"Rs"
"1984-01-13";"SAO PAULO";"SP"
"1990-05-03";"Porto Alegre";"Rs"
"1980-09-18";"Passo Fundo";"Rs"
"2002-02-03";"Araguari";"MG"
"1982-10-31";"SAO PAULO";"SP"
"1983-07-17";"SAO PAULO";"SP"
"1983-11-09";"Passo Fundo";"Rs"
"1966-06-04";"Porto Alegre";"Rs"
"1988-03-18";"Passo Fundo";"Rs"
"1989-08-06";"Belo Horizonte";"MG"
"1990-04-25";"Santa Maria";"Rs"
"1994-07-23";"Blumenau";"SC"
"1990-06-03";"Cristalandia";"TO"
"1986-03-15";"SAO PAULO";"SP"
"1971-11-15";"Santa Maria";"Rs"
"1991-03-09";"Abreulandia";"TO"
"1990-09-26";"Conceicao do Tocantins";"TO"
"1983-05-03";"SAO PAULO";"SP"
"1986-01-11";"SAO PAULO";"SP"
"1983-05-11";"Santa Maria";"Rs"
"1965-09-25";"Passo Fundo";"Rs"
"1993-10-08";"Santa Maria";"Rs"
"1930-11-21";"Santa Bárbara D Oeste";"SP"
"1988-04-15";"Sertaozinho";"SP"
"1986-06-23";"Porto Alegre";"Rs"
"1983-09-18";"Londrina";"PR"
"1998-09-18";"Salvador";"BA"
"1958-10-02";"Belo Horizonte";"MG"
"1991-02-07";"Uberlandia";"MG"
"1981-08-01";"Porto Alegre";"Rs"
"1983-07-09";"SAO PAULO";"SP"
"1992-08-01";"Passo Fundo";"Rs"
"1993-09-10";"Porto Alegre";"Rs"
"1978-09-29";"Passo Fundo";"Rs"
"1986-12-17";"Porto Nacional";"TO"
"1985-12-04";"SAO PAULO";"SP"
"1986-07-21";"SAO PAULO";"SP"
"1978-08-16";"Blumenau";"SC"
"1989-07-18";"Passo Fundo";"Rs"
"1987-05-14";"Santa Maria";"Rs"
"1992-11-25";"Uberlandia";"MG"
"1983-11-11";"SAO PAULO";"SP"
"1969-05-09";"Belo Horizonte";"MG"
"1993-01-04";"Porto Alegre";"Rs"
"1993-03-03";"Porto Velho";"RO"
"1983-12-30";"Porto Alegre";"Rs"
"1988-10-07";"Passo Fundo";"Rs"
"1980-04-27";"Passo Fundo";"Rs"
"1988-05-25";"Palmas";"TO"
"1982-06-18";"Passo Fundo";"Rs"
"1986-04-16";"Passo Fundo";"Rs"
"1982-08-16";"Santa Maria";"Rs"
*/
	-- (f) Listar todos os municípios que possuem agências dos estados de 'SP' e 'MG'
SELECT municipio FROM agencia WHERE UPPER(estado) IN ('SP','MG') GROUP BY municipio ORDER BY municipio;
/*
"Bebedouro"
"Belo Horizonte"
"Itapira"
"Juiz de Fora"
"Mirandopolis"
"Ribeirão Bonito"
"SAO PAULO"
"Sertãozinho"
"Uberlândia"
*/
    -- (g) Listar todos as agências (código da agência) que possuem funcionários que não são gerentes de clientes.
SELECT agencia FROM funcionario WHERE num_funcional NOT IN (SELECT gerente from cliente) GROUP BY agencia;
/*
"0775"
"2918"
"1792"
"1797"
*/
    -- (g) Listar todos as agências (código da agência) que em que não há nenhum gerente de cliente.
SELECT agencia FROM funcionario WHERE num_funcional NOT IN (SELECT gerente from cliente) AND agencia NOT IN (SELECT agencia FROM funcionario WHERE num_funcional IN (SELECT gerente from cliente)) GROUP BY agencia;
/*
"0775"
"1792"
"1797"
*/
 	
-- 17) CONSULTAS COM AGRUPAMENTOS E FUNÇÕES AGREGADAS
    -- (a) Listar a quantidade de funcionários por agência (mostrar o código da agência e o número de funcionários)
SELECT agencia,count(*) FROM funcionario GROUP BY agencia ORDER BY count;
/*
"1709";1
"1303";1
"0775";1
"5874";1
"1708";1
"1100";1
"1304";1
"1101";1
"0095";1
"1792";1
"1797";1
"1323";1
"1102";1
"0411";1
"0706";1
"0743";1
"3928";1
"1808";1
"1232";1
"1701";1
"1301";1
"1302";1
"1300";1
"1707";1
"0128";1
"1324";1
"7134";1
"1103";1
"3075";1
"1001";1
"1221";1
"1710";1
"2918";2
"1104";2
"3534";3
"2692";3
"1484";3
"3536";3
"2794";3
"1602";4
"1600";4
"1618";4
"1604";4
"1611";4
"1616";4
"1613";4
"1601";4
"1624";4
"1610";4
"1603";4
"1615";4
"1620";4
"1609";4
"1614";4
"1606";4
"1608";4
"1617";4
"1621";4
"1605";4
"1623";4
"1607";4
"1622";4
"1612";4
"1619";4
*/
	-- (b) Para os funcionários que possuem dependentes, listar o número funcional de cada funcionário 
	       --juntamente com o número de dependentes que eles possuem
select funcionario, count(funcionario) from dependentes group by funcionario order by count
/*
1604;1
1721;1
903;1
103;1
1301;1
801;1
1618;1
1728;1
4;1
700;1
1603;1
1614;1
101;1
1624;1
1303;1
1612;1
800;1
1;1
1601;1
1620;1
1720;1
1617;1
1605;1
1600;1
1611;1
1607;1
702;1
1729;1
5;1
1623;1
1615;1
3;1
901;1
1613;1
1304;1
703;1
1616;1
902;1
1300;1
900;1
1722;1
1609;1
1621;1
701;1
704;1
904;1
1608;1
1602;1
100;1
804;1
1302;1
1610;1
104;1
102;1
1622;1
1606;1
2;1
1619;1
1104;2
1640;2
1644;2
1643;2
1105;2
1642;2
1633;2
1639;2
1637;2
802;2
1632;2
1102;2
1638;2
1646;2
1101;2
1630;2
1641;2
1626;2
1645;2
1628;2
1647;2
1649;2
1103;2
1634;2
1627;2
1625;2
1100;2
1636;2
1631;2
1635;2
1629;2
1650;2
1648;2
1653;3
1669;3
1674;3
1670;3
1664;3
1668;3
1652;3
1666;3
1659;3
1656;3
1661;3
1658;3
1671;3
1673;3
1662;3
1651;3
1655;3
1663;3
1665;3
1654;3
1667;3
1672;3
1660;3
1657;3
*/
	-- (c) Listar para cada data cadastrada a quantidade de clientes que nasceram na respectiva data
SELECT data_nasc,count(*) FROM cliente GROUP BY data_nasc ORDER BY count DESC;
/*
"1985-02-25";4
"1983-05-03";4
"1983-02-07";4
"1986-08-05";4
"1982-10-31";4
"1983-07-17";4
"1986-01-08";4
"1986-01-11";4
"1984-04-18";4
"1986-05-24";4
"1983-09-24";4
"1984-01-13";4
"1981-06-03";4
"1985-06-03";4
"1985-12-04";4
"1983-07-29";4
"1986-07-21";4
"1981-06-27";4
"1982-04-27";4
"1981-07-21";4
"1982-12-28";4
"1985-04-22";4
"1983-07-09";4
"1983-11-11";4
"1986-03-15";4
"1983-11-09";1
"1991-02-07";1
"1986-06-23";1
"1990-06-29";1
"2000-01-01";1
"1991-02-03";1
"1990-04-27";1
"1993-08-27";1
"1987-08-19";1
"1987-05-14";1
"1940-10-12";1
"1990-04-25";1
"1974-05-08";1
"1989-08-06";1
"1991-03-09";1
"1958-10-02";1
"1989-02-28";1
"1989-07-18";1
"1983-12-11";1
"1994-05-14";1
"1995-05-05";1
"1983-12-30";1
"1994-07-23";1
"1988-05-25";1
"1981-05-23";1
"1991-01-01";1
"1995-02-20";1
"1980-10-29";1
"1984-10-31";1
"1988-04-15";1
"1989-12-06";1
"1987-07-17";1
"1997-12-16";1
"1956-03-18";1
"1969-05-09";1
"1990-03-03";1
"1975-06-07";1
"1990-03-18";1
"1991-03-03";1
"1988-10-07";1
"1982-06-18";1
"1980-04-27";1
"1986-04-16";1
"1964-01-12";1
"1990-01-10";1
"1990-12-01";1
"1980-09-18";1
"1988-03-18";1
"1989-12-16";1
"1989-03-23";1
"1982-05-16";1
"1987-12-28";1
"1994-04-04";1
"1982-08-16";1
"1990-06-03";1
"1971-11-15";1
"1983-05-11";1
"1978-08-16";1
"1981-05-04";1
"1986-12-17";1
"1988-11-04";1
"1993-03-03";1
"1930-11-21";1
"1980-01-11";1
"1991-07-07";1
"1983-02-13";1
"1992-06-26";1
"1948-08-02";1
"1983-03-06";1
"1992-08-01";1
"1987-07-28";1
"1998-09-18";1
"1994-01-10";1
"1966-06-04";1
"1991-09-04";1
"1991-03-27";1
"1990-09-26";1
"1981-08-01";1
"1993-09-10";1
"1993-01-04";1
"1985-02-07";1
"1993-10-08";1
"1992-02-02";1
"2002-02-03";1
"1978-09-29";1
"1987-04-12";1
"1979-01-31";1
"1990-06-21";1
"1982-11-12";1
"1990-05-03";1
"1965-09-25";1
"1983-09-18";1
"1992-11-25";1
*/
	-- (d) Listar a quantidade de agências por município e estado
SELECT municipio,estado,count(*) FROM agencia GROUP BY municipio,estado ORDER BY municipio,estado;
/*
"Amamba";"MS";1
"Anaurilandia";"MS";1
"Angelica";"MS";1
"Aparecida do Taboado";"MS";1
"Aquidauana";"MS";1
"Araguaina";"TO";1
"Bebedouro";"SP";1
"Belo Horizonte";"MG";1
"Bernardo Sayao";"TO";1
"blumenau";"SC";5
"Gurupi";"TO";2
"Itapira";"SP";1
"Juiz de Fora";"MG";1
"Mirandopolis";"SP";1
"Palmas";"TO";1
"Passo Fundo";"RS";2
"Porto Alegre";"RS";2
"Porto Velho";"RO";5
"Ribeirão Bonito";"SP";1
"RIO DE JANEIRO";"RJ";4
"Santa Maria";"RS";1
"SAO PAULO";"SP";25
"Sertãozinho";"SP";1
"TERESOPOLIS";"RJ";1
"Uberlândia";"MG";3
*/
	-- (e) Listar o código de cada agência em que trabalham funcionários juntamente com a data de admissão mais recente
SELECT agencia,MAX(data_admissao) FROM funcionario GROUP BY agencia ORDER BY agencia;
/*
"0095";"2010-07-23"
"0128";"2008-09-12"
"0411";"2007-04-12"
"0706";"2002-03-08"
"0743";"2015-02-12"
"0775";"2008-02-15"
"1001";"2008-04-05"
"1100";"2016-10-06"
"1101";"2016-10-06"
"1102";"2016-10-06"
"1103";"2016-10-06"
"1104";"2016-10-06"
"1221";"2009-03-12"
"1232";"2005-02-12"
"1300";"1991-01-01"
"1301";"1992-02-02"
"1302";"1993-03-03"
"1303";"1994-04-04"
"1304";"1995-05-05"
"1323";"2012-04-05"
"1324";"1992-10-02"
"1484";"2004-05-01"
"1600";"2011-06-03"
"1601";"2011-06-27"
"1602";"2011-07-21"
"1603";"2012-04-27"
"1604";"2012-10-31"
"1605";"2012-12-28"
"1606";"2013-02-07"
"1607";"2013-05-03"
"1608";"2013-07-09"
"1609";"2013-07-17"
"1610";"2013-07-29"
"1611";"2013-09-24"
"1612";"2013-11-11"
"1613";"2014-01-13"
"1614";"2014-04-18"
"1615";"2015-02-25"
"1616";"2015-04-22"
"1617";"2015-06-03"
"1618";"2015-12-04"
"1619";"2016-01-08"
"1620";"2016-01-11"
"1621";"2016-03-15"
"1622";"2016-05-24"
"1623";"2016-07-21"
"1624";"2016-08-05"
"1701";"2016-01-08"
"1707";"2016-08-09"
"1708";"2015-03-01"
"1709";"2014-02-02"
"1710";"2015-01-12"
"1792";"2003-05-14"
"1797";"1996-05-04"
"1808";"2009-11-11"
"2692";"2004-05-01"
"2794";"2004-05-01"
"2918";"2011-09-01"
"3075";"2009-06-14"
"3534";"2004-05-01"
"3536";"2004-05-01"
"3928";"2016-03-12"
"5874";"2008-04-06"
"7134";"2006-06-12"
*/
	-- (f) Listar todas as contas que efeturam operações. Mostrar jutamente o maior valor de operação da conta
SELECT cod_agencia,numero_conta,MAX(valor) FROM operacao GROUP BY cod_agencia,numero_conta ORDER BY cod_agencia,numero_conta;
/*
"0095";123;10.00
"0128";456;5.00
"0411";789;40.00
"0706";993997;1200.00
"0743";899769;200.00
"0775";196;3500.00
"1001";701;10212.00
"1100";1100;15.00
"1100";1101;123.00
"1100";1102;7.26
"1100";1103;53.23
"1100";1104;42.75
"1101";1100;540.00
"1101";1101;25.00
"1101";1102;15.00
"1101";1103;50.00
"1101";1104;75.00
"1102";1100;15.00
"1102";1101;23.40
"1102";1102;27.85
"1102";1103;717.00
"1102";1104;15.00
"1103";1100;50.00
"1103";1101;15.00
"1103";1102;250.00
"1103";1103;15.00
"1103";1104;950.00
"1104";1100;15.00
"1104";1101;113.00
"1104";1102;15.00
"1104";1103;75.00
"1104";1104;15.00
"1221";702;412.00
"1221";704;212.50
"1232";987;3000.00
"1300";1;1000000000.00
"1301";1;1000000000.00
"1302";1;1000000000.00
"1303";1;1000000000.00
"1304";1;1000000000.00
"1323";908837;600.00
"1324";993005;2700.00
"1484";14800;300.23
"1600";1;100.00
"1600";2;2600.00
"1600";3;5100.00
"1600";4;7600.00
"1601";1;200.00
"1601";2;2700.00
"1601";3;5200.00
"1601";4;7700.00
"1602";1;300.00
"1602";2;2800.00
"1602";3;5300.00
"1602";4;7800.00
"1603";1;400.00
"1603";2;2900.00
"1603";3;5400.00
"1603";4;7900.00
"1604";1;500.00
"1604";2;3000.00
"1604";3;5500.00
"1604";4;8000.00
"1605";1;600.00
"1605";2;3100.00
"1605";3;5600.00
"1605";4;8100.00
"1606";1;700.00
"1606";2;3200.00
"1606";3;5700.00
"1606";4;8200.00
"1607";1;800.00
"1607";2;3300.00
"1607";3;5800.00
"1607";4;8300.00
"1608";1;900.00
"1608";2;3400.00
"1608";3;5900.00
"1608";4;8400.00
"1609";1;1000.00
"1609";2;3500.00
"1609";3;6000.00
"1609";4;8500.00
"1610";1;1100.00
"1610";2;3600.00
"1610";3;6100.00
"1610";4;8600.00
"1611";1;1200.00
"1611";2;3700.00
"1611";3;6200.00
"1611";4;8700.00
"1612";1;1300.00
"1612";2;3800.00
"1612";3;6300.00
"1612";4;8800.00
"1613";1;1400.00
"1613";2;3900.00
"1613";3;6400.00
"1613";4;8900.00
"1614";1;1500.00
"1614";2;4000.00
"1614";3;6500.00
"1614";4;9000.00
"1615";1;1600.00
"1615";2;4100.00
"1615";3;6600.00
"1615";4;9100.00
"1616";1;1700.00
"1616";2;4200.00
"1616";3;6700.00
"1616";4;9200.00
"1617";1;1800.00
"1617";2;4300.00
"1617";3;6800.00
"1617";4;9300.00
"1618";1;1900.00
"1618";2;4400.00
"1618";3;6900.00
"1618";4;9400.00
"1619";1;2000.00
"1619";2;4500.00
"1619";3;7000.00
"1619";4;9500.00
"1620";1;2100.00
"1620";2;4600.00
"1620";3;7100.00
"1620";4;9600.00
"1621";1;2200.00
"1621";2;4700.00
"1621";3;7200.00
"1621";4;9700.00
"1622";1;2300.00
"1622";2;4800.00
"1622";3;7300.00
"1622";4;9800.00
"1623";1;2400.00
"1623";2;4900.00
"1623";3;7400.00
"1623";4;9900.00
"1624";1;2500.00
"1624";2;5000.00
"1624";3;7500.00
"1624";4;10000.00
"1701";1789;300.00
"1707";1799;687.55
"1708";1798;30.00
"1709";1777;50.00
"1710";1788;250.00
"1792";199;500.00
"1797";197;250.00
"1808";195;5.00
"2692";26901;320.00
"2794";27100;300.23
"2918";703;2612.23
"3075";198;2500.00
"3534";35400;547.23
"3536";35600;7430.00
"3928";997790;100.00
"5874";700;12.45
"7134";321;20.00
*/
	-- (g) Listar todas as contas que efeturam operações. Mostrar jutamente o maior, o menor, a média e desvio 
	         -- padrão dos valores de operação da conta
SELECT cod_agencia,numero_conta,MAX(valor),MIN(valor),AVG(valor),COALESCE(STDDEV_SAMP(valor),0) FROM operacao GROUP BY cod_agencia,numero_conta ORDER BY cod_agencia,numero_conta;
/*
"0095";123;10.00;10.00;10.0000000000000000;0
"0128";456;5.00;5.00;5.0000000000000000;0
"0411";789;40.00;40.00;40.0000000000000000;0
"0706";993997;1200.00;1200.00;1200.0000000000000000;0
"0743";899769;200.00;200.00;200.0000000000000000;0
"0775";196;3500.00;3500.00;3500.0000000000000000;0
"1001";701;10212.00;10212.00;10212.0000000000000000;0
"1100";1100;15.00;15.00;15.0000000000000000;0
"1100";1101;123.00;123.00;123.0000000000000000;0
"1100";1102;7.26;7.26;7.2600000000000000;0
"1100";1103;53.23;53.23;53.2300000000000000;0
"1100";1104;42.75;42.75;42.7500000000000000;0
"1101";1100;540.00;540.00;540.0000000000000000;0
"1101";1101;25.00;25.00;25.0000000000000000;0
"1101";1102;15.00;15.00;15.0000000000000000;0
"1101";1103;50.00;50.00;50.0000000000000000;0
"1101";1104;75.00;75.00;75.0000000000000000;0
"1102";1100;15.00;15.00;15.0000000000000000;0
"1102";1101;23.40;23.40;23.4000000000000000;0
"1102";1102;27.85;27.85;27.8500000000000000;0
"1102";1103;717.00;717.00;717.0000000000000000;0
"1102";1104;15.00;15.00;15.0000000000000000;0
"1103";1100;50.00;50.00;50.0000000000000000;0
"1103";1101;15.00;15.00;15.0000000000000000;0
"1103";1102;250.00;250.00;250.0000000000000000;0
"1103";1103;15.00;15.00;15.0000000000000000;0
"1103";1104;950.00;950.00;950.0000000000000000;0
"1104";1100;15.00;15.00;15.0000000000000000;0
"1104";1101;113.00;113.00;113.0000000000000000;0
"1104";1102;15.00;15.00;15.0000000000000000;0
"1104";1103;75.00;75.00;75.0000000000000000;0
"1104";1104;15.00;15.00;15.0000000000000000;0
"1221";702;412.00;412.00;412.0000000000000000;0
"1221";704;212.50;212.50;212.5000000000000000;0
"1232";987;3000.00;3000.00;3000.0000000000000000;0
"1300";1;1000000000.00;1000000000.00;1000000000.00000000;0
"1301";1;1000000000.00;1000000000.00;1000000000.00000000;0
"1302";1;1000000000.00;1000000000.00;1000000000.00000000;0
"1303";1;1000000000.00;1000000000.00;1000000000.00000000;0
"1304";1;1000000000.00;1000000000.00;1000000000.00000000;0
"1323";908837;600.00;600.00;600.0000000000000000;0
"1324";993005;2700.00;2700.00;2700.0000000000000000;0
"1484";14800;300.23;300.23;300.2300000000000000;0
"1600";1;100.00;100.00;100.0000000000000000;0
"1600";2;2600.00;2600.00;2600.0000000000000000;0
"1600";3;5100.00;5100.00;5100.0000000000000000;0
"1600";4;7600.00;7600.00;7600.0000000000000000;0
"1601";1;200.00;200.00;200.0000000000000000;0
"1601";2;2700.00;2700.00;2700.0000000000000000;0
"1601";3;5200.00;5200.00;5200.0000000000000000;0
"1601";4;7700.00;7700.00;7700.0000000000000000;0
"1602";1;300.00;300.00;300.0000000000000000;0
"1602";2;2800.00;2800.00;2800.0000000000000000;0
"1602";3;5300.00;5300.00;5300.0000000000000000;0
"1602";4;7800.00;7800.00;7800.0000000000000000;0
"1603";1;400.00;400.00;400.0000000000000000;0
"1603";2;2900.00;2900.00;2900.0000000000000000;0
"1603";3;5400.00;5400.00;5400.0000000000000000;0
"1603";4;7900.00;7900.00;7900.0000000000000000;0
"1604";1;500.00;500.00;500.0000000000000000;0
"1604";2;3000.00;3000.00;3000.0000000000000000;0
"1604";3;5500.00;5500.00;5500.0000000000000000;0
"1604";4;8000.00;8000.00;8000.0000000000000000;0
"1605";1;600.00;600.00;600.0000000000000000;0
"1605";2;3100.00;3100.00;3100.0000000000000000;0
"1605";3;5600.00;5600.00;5600.0000000000000000;0
"1605";4;8100.00;8100.00;8100.0000000000000000;0
"1606";1;700.00;700.00;700.0000000000000000;0
"1606";2;3200.00;3200.00;3200.0000000000000000;0
"1606";3;5700.00;5700.00;5700.0000000000000000;0
"1606";4;8200.00;8200.00;8200.0000000000000000;0
"1607";1;800.00;800.00;800.0000000000000000;0
"1607";2;3300.00;3300.00;3300.0000000000000000;0
"1607";3;5800.00;5800.00;5800.0000000000000000;0
"1607";4;8300.00;8300.00;8300.0000000000000000;0
"1608";1;900.00;900.00;900.0000000000000000;0
"1608";2;3400.00;3400.00;3400.0000000000000000;0
"1608";3;5900.00;5900.00;5900.0000000000000000;0
"1608";4;8400.00;8400.00;8400.0000000000000000;0
"1609";1;1000.00;1000.00;1000.0000000000000000;0
"1609";2;3500.00;3500.00;3500.0000000000000000;0
"1609";3;6000.00;6000.00;6000.0000000000000000;0
"1609";4;8500.00;8500.00;8500.0000000000000000;0
"1610";1;1100.00;1100.00;1100.0000000000000000;0
"1610";2;3600.00;3600.00;3600.0000000000000000;0
"1610";3;6100.00;6100.00;6100.0000000000000000;0
"1610";4;8600.00;8600.00;8600.0000000000000000;0
"1611";1;1200.00;1200.00;1200.0000000000000000;0
"1611";2;3700.00;3700.00;3700.0000000000000000;0
"1611";3;6200.00;6200.00;6200.0000000000000000;0
"1611";4;8700.00;8700.00;8700.0000000000000000;0
"1612";1;1300.00;1300.00;1300.0000000000000000;0
"1612";2;3800.00;3800.00;3800.0000000000000000;0
"1612";3;6300.00;6300.00;6300.0000000000000000;0
"1612";4;8800.00;8800.00;8800.0000000000000000;0
"1613";1;1400.00;1400.00;1400.0000000000000000;0
"1613";2;3900.00;3900.00;3900.0000000000000000;0
"1613";3;6400.00;6400.00;6400.0000000000000000;0
"1613";4;8900.00;8900.00;8900.0000000000000000;0
"1614";1;1500.00;1500.00;1500.0000000000000000;0
"1614";2;4000.00;4000.00;4000.0000000000000000;0
"1614";3;6500.00;6500.00;6500.0000000000000000;0
"1614";4;9000.00;9000.00;9000.0000000000000000;0
"1615";1;1600.00;1600.00;1600.0000000000000000;0
"1615";2;4100.00;4100.00;4100.0000000000000000;0
"1615";3;6600.00;6600.00;6600.0000000000000000;0
"1615";4;9100.00;9100.00;9100.0000000000000000;0
"1616";1;1700.00;1700.00;1700.0000000000000000;0
"1616";2;4200.00;4200.00;4200.0000000000000000;0
"1616";3;6700.00;6700.00;6700.0000000000000000;0
"1616";4;9200.00;9200.00;9200.0000000000000000;0
"1617";1;1800.00;1800.00;1800.0000000000000000;0
"1617";2;4300.00;4300.00;4300.0000000000000000;0
"1617";3;6800.00;6800.00;6800.0000000000000000;0
"1617";4;9300.00;9300.00;9300.0000000000000000;0
"1618";1;1900.00;1900.00;1900.0000000000000000;0
"1618";2;4400.00;4400.00;4400.0000000000000000;0
"1618";3;6900.00;6900.00;6900.0000000000000000;0
"1618";4;9400.00;9400.00;9400.0000000000000000;0
"1619";1;2000.00;2000.00;2000.0000000000000000;0
"1619";2;4500.00;4500.00;4500.0000000000000000;0
"1619";3;7000.00;7000.00;7000.0000000000000000;0
"1619";4;9500.00;9500.00;9500.0000000000000000;0
"1620";1;2100.00;2100.00;2100.0000000000000000;0
"1620";2;4600.00;4600.00;4600.0000000000000000;0
"1620";3;7100.00;7100.00;7100.0000000000000000;0
"1620";4;9600.00;9600.00;9600.0000000000000000;0
"1621";1;2200.00;2200.00;2200.0000000000000000;0
"1621";2;4700.00;4700.00;4700.0000000000000000;0
"1621";3;7200.00;7200.00;7200.0000000000000000;0
"1621";4;9700.00;9700.00;9700.0000000000000000;0
"1622";1;2300.00;2300.00;2300.0000000000000000;0
"1622";2;4800.00;4800.00;4800.0000000000000000;0
"1622";3;7300.00;7300.00;7300.0000000000000000;0
"1622";4;9800.00;9800.00;9800.0000000000000000;0
"1623";1;2400.00;2400.00;2400.0000000000000000;0
"1623";2;4900.00;4900.00;4900.0000000000000000;0
"1623";3;7400.00;7400.00;7400.0000000000000000;0
"1623";4;9900.00;9900.00;9900.0000000000000000;0
"1624";1;2500.00;2500.00;2500.0000000000000000;0
"1624";2;5000.00;5000.00;5000.0000000000000000;0
"1624";3;7500.00;7500.00;7500.0000000000000000;0
"1624";4;10000.00;10000.00;10000.0000000000000000;0
"1701";1789;300.00;300.00;300.0000000000000000;0
"1707";1799;687.55;687.55;687.5500000000000000;0
"1708";1798;30.00;30.00;30.0000000000000000;0
"1709";1777;50.00;50.00;50.0000000000000000;0
"1710";1788;250.00;250.00;250.0000000000000000;0
"1792";199;500.00;500.00;500.0000000000000000;0
"1797";197;250.00;250.00;250.0000000000000000;0
"1808";195;5.00;5.00;5.0000000000000000;0
"2692";26901;320.00;56.43;198.8575000000000000;120.786483342853
"2794";27100;300.23;20.00;160.1150000000000000;198.152533291906
"2918";703;2612.23;2612.23;2612.2300000000000000;0
"3075";198;2500.00;2500.00;2500.0000000000000000;0
"3534";35400;547.23;300.23;423.7300000000000000;174.655374953077
"3536";35600;7430.00;34.00;2701.3333333333333333;4106.339651482002
"3928";997790;100.00;100.00;100.0000000000000000;0
"5874";700;12.45;12.45;12.4500000000000000;0
"7134";321;20.00;20.00;20.0000000000000000;0
*/
	-- (h) Listar para cada conta a quantidade de clientes que a possui.
SELECT cod_agencia,numero_conta,count(*) FROM clienteconta GROUP BY cod_agencia,numero_conta ORDER BY cod_agencia,numero_conta;
/*
"0095";123;1
"0128";456;1
"0411";789;1
"0706";993997;1
"0743";899769;1
"0775";196;1
"1001";701;1
"1100";1100;1
"1100";1101;1
"1100";1102;1
"1100";1103;1
"1100";1104;1
"1101";1100;1
"1101";1101;1
"1101";1102;1
"1101";1103;1
"1101";1104;1
"1102";1100;1
"1102";1101;1
"1102";1102;1
"1102";1103;1
"1102";1104;1
"1103";1100;1
"1103";1101;1
"1103";1102;1
"1103";1103;1
"1103";1104;1
"1104";1100;1
"1104";1101;1
"1104";1102;1
"1104";1103;1
"1104";1104;1
"1221";702;1
"1221";704;1
"1232";987;1
"1300";1;1
"1301";1;1
"1302";1;1
"1303";1;1
"1304";1;1
"1323";908837;1
"1324";993005;1
"1484";14800;1
"1484";14801;1
"1484";14802;1
"1484";14803;1
"1484";14804;1
"1484";14805;1
"1484";14806;1
"1484";14807;1
"1484";14808;1
"1484";14809;1
"1484";14810;1
"1484";14811;1
"1484";14812;1
"1600";1;1
"1600";2;1
"1600";3;1
"1600";4;1
"1601";1;1
"1601";2;1
"1601";3;1
"1601";4;1
"1602";1;1
"1602";2;1
"1602";3;1
"1602";4;1
"1603";1;1
"1603";2;1
"1603";3;1
"1603";4;1
"1604";1;1
"1604";2;1
"1604";3;1
"1604";4;1
"1605";1;1
"1605";2;1
"1605";3;1
"1605";4;1
"1606";1;1
"1606";2;1
"1606";3;1
"1606";4;1
"1607";1;1
"1607";2;1
"1607";3;1
"1607";4;1
"1608";1;1
"1608";2;1
"1608";3;1
"1608";4;1
"1609";1;1
"1609";2;1
"1609";3;1
"1609";4;1
"1610";1;1
"1610";2;1
"1610";3;1
"1610";4;1
"1611";1;1
"1611";2;1
"1611";3;1
"1611";4;1
"1612";1;1
"1612";2;1
"1612";3;1
"1612";4;1
"1613";1;1
"1613";2;1
"1613";3;1
"1613";4;1
"1614";1;1
"1614";2;1
"1614";3;1
"1614";4;1
"1615";1;1
"1615";2;1
"1615";3;1
"1615";4;1
"1616";1;1
"1616";2;1
"1616";3;1
"1616";4;1
"1617";1;1
"1617";2;1
"1617";3;1
"1617";4;1
"1618";1;1
"1618";2;1
"1618";3;1
"1618";4;1
"1619";1;1
"1619";2;1
"1619";3;1
"1619";4;1
"1620";1;1
"1620";2;1
"1620";3;1
"1620";4;1
"1621";1;1
"1621";2;1
"1621";3;1
"1621";4;1
"1622";1;1
"1622";2;1
"1622";3;1
"1622";4;1
"1623";1;1
"1623";2;1
"1623";3;1
"1623";4;1
"1624";1;1
"1624";2;1
"1624";3;1
"1624";4;1
"1701";1789;1
"1707";1799;1
"1708";1798;1
"1709";1777;1
"1710";1788;1
"1792";199;1
"1797";197;1
"1808";195;1
"2692";26900;1
"2692";26901;1
"2692";26902;1
"2692";26903;1
"2692";26904;1
"2692";26905;1
"2692";26906;1
"2692";26907;1
"2692";26908;1
"2692";26909;1
"2692";26910;1
"2692";26911;1
"2794";27100;1
"2794";27101;1
"2794";27102;1
"2794";27103;1
"2794";27104;1
"2794";27105;1
"2794";27106;1
"2794";27107;1
"2794";27108;1
"2794";27109;1
"2794";27110;1
"2918";703;1
"3075";198;1
"3534";35400;1
"3534";35401;1
"3534";35402;1
"3534";35403;1
"3534";35404;1
"3534";35405;1
"3534";35406;1
"3534";35407;1
"3534";35408;1
"3534";35409;1
"3534";35410;1
"3534";35411;1
"3536";35600;1
"3536";35601;1
"3536";35602;1
"3536";35603;1
"3536";35604;1
"3536";35605;1
"3536";35606;1
"3536";35607;1
"3536";35608;1
"3536";35609;1
"3536";35610;1
"3536";35611;1
"3928";997790;1
"5874";700;1
"7134";321;1
*/
	-- (i) Listar o número funcional dos gerentes jutamente com o número de clientes que eles gerenciam
SELECT gerente,count(*) FROM cliente GROUP BY gerente ORDER BY count DESC;
/*
104;4
802;4
805;4
814;4
806;4
801;4
808;4
803;3
813;3
812;3
809;3
1100;3
810;3
804;3
807;3
800;3
811;2
1104;2
1103;2
1101;2
1105;2
1102;2
702;2
1645;1
1628;1
1679;1
1680;1
1647;1
1614;1
1627;1
1659;1
101;1
1624;1
1631;1
1303;1
1612;1
1685;1
1;1
1601;1
1640;1
1673;1
1662;1
1699;1
1651;1
1620;1
1696;1
1720;1
1617;1
1605;1
1698;1
1600;1
1611;1
1638;1
1646;1
1665;1
1691;1
1697;1
1630;1
1607;1
1729;1
1672;1
1660;1
5;1
1623;1
1669;1
1670;1
1615;1
1650;1
3;1
901;1
1642;1
1652;1
1613;1
1649;1
1304;1
703;1
1635;1
1693;1
1616;1
902;1
1300;1
1686;1
900;1
1694;1
1722;1
1609;1
1655;1
1678;1
1689;1
1621;1
1687;1
1653;1
1626;1
701;1
1682;1
1604;1
1608;1
1648;1
1644;1
1602;1
1656;1
1658;1
1695;1
1302;1
1633;1
1677;1
1688;1
1639;1
1683;1
1637;1
1610;1
1667;1
1657;1
1634;1
1664;1
1641;1
1622;1
1663;1
1606;1
1629;1
2;1
1661;1
1671;1
904;1
1619;1
1654;1
1721;1
1674;1
903;1
1643;1
1625;1
1301;1
1636;1
1618;1
1728;1
1668;1
1676;1
1690;1
1681;1
1692;1
4;1
1675;1
700;1
1632;1
1666;1
1684;1
1603;1
*/
	-- (j) Listar o número funcional dos supervisores juntamente com o número de empregados que eles supervisionam
SELECT supervisor,count(*) FROM funcionario WHERE supervisor IS NOT NULL GROUP BY supervisor ORDER BY count DESC;
/*
1304;4
100;4
900;4
1623;3
1612;3
1615;3
1608;3
1602;3
1618;3
1620;3
1613;3
1617;3
1605;3
1610;3
1616;3
1600;3
1611;3
1603;3
1622;3
1606;3
1614;3
1607;3
1609;3
1624;3
1619;3
1621;3
1601;3
1604;3
802;2
703;2
800;2
804;2
803;2
801;2
1722;1
4;1
1;1
3;1
1729;1
1101;1
5;1
1100;1
700;1
2;1
701;1
1728;1
1721;1
1720;1
702;1
*/
    -- (k) Listar para cada estado o número de municípios que possuem agências. Lembre que em um município pode 
	       -- haver mais de uma agência
SELECT estado,COUNT(DISTINCT municipio) FROM agencia GROUP BY estado ORDER BY estado;
/*
"MG";3
"MS";5
"RJ";2
"RO";1
"RS";3
"SC";1
"SP";6
"TO";4
*/
    -- (l) Listar a agência, a conta e o valor médio da operações bancárias de cada conta.
SELECT cod_agencia,numero_conta,AVG(valor) FROM operacao GROUP BY cod_agencia,numero_conta ORDER BY cod_agencia,numero_conta;
/*
"0095";123;10.0000000000000000
"0128";456;5.0000000000000000
"0411";789;40.0000000000000000
"0706";993997;1200.0000000000000000
"0743";899769;200.0000000000000000
"0775";196;3500.0000000000000000
"1001";701;10212.0000000000000000
"1100";1100;15.0000000000000000
"1100";1101;123.0000000000000000
"1100";1102;7.2600000000000000
"1100";1103;53.2300000000000000
"1100";1104;42.7500000000000000
"1101";1100;540.0000000000000000
"1101";1101;25.0000000000000000
"1101";1102;15.0000000000000000
"1101";1103;50.0000000000000000
"1101";1104;75.0000000000000000
"1102";1100;15.0000000000000000
"1102";1101;23.4000000000000000
"1102";1102;27.8500000000000000
"1102";1103;717.0000000000000000
"1102";1104;15.0000000000000000
"1103";1100;50.0000000000000000
"1103";1101;15.0000000000000000
"1103";1102;250.0000000000000000
"1103";1103;15.0000000000000000
"1103";1104;950.0000000000000000
"1104";1100;15.0000000000000000
"1104";1101;113.0000000000000000
"1104";1102;15.0000000000000000
"1104";1103;75.0000000000000000
"1104";1104;15.0000000000000000
"1221";702;412.0000000000000000
"1221";704;212.5000000000000000
"1232";987;3000.0000000000000000
"1300";1;1000000000.00000000
"1301";1;1000000000.00000000
"1302";1;1000000000.00000000
"1303";1;1000000000.00000000
"1304";1;1000000000.00000000
"1323";908837;600.0000000000000000
"1324";993005;2700.0000000000000000
"1484";14800;300.2300000000000000
"1600";1;100.0000000000000000
"1600";2;2600.0000000000000000
"1600";3;5100.0000000000000000
"1600";4;7600.0000000000000000
"1601";1;200.0000000000000000
"1601";2;2700.0000000000000000
"1601";3;5200.0000000000000000
"1601";4;7700.0000000000000000
"1602";1;300.0000000000000000
"1602";2;2800.0000000000000000
"1602";3;5300.0000000000000000
"1602";4;7800.0000000000000000
"1603";1;400.0000000000000000
"1603";2;2900.0000000000000000
"1603";3;5400.0000000000000000
"1603";4;7900.0000000000000000
"1604";1;500.0000000000000000
"1604";2;3000.0000000000000000
"1604";3;5500.0000000000000000
"1604";4;8000.0000000000000000
"1605";1;600.0000000000000000
"1605";2;3100.0000000000000000
"1605";3;5600.0000000000000000
"1605";4;8100.0000000000000000
"1606";1;700.0000000000000000
"1606";2;3200.0000000000000000
"1606";3;5700.0000000000000000
"1606";4;8200.0000000000000000
"1607";1;800.0000000000000000
"1607";2;3300.0000000000000000
"1607";3;5800.0000000000000000
"1607";4;8300.0000000000000000
"1608";1;900.0000000000000000
"1608";2;3400.0000000000000000
"1608";3;5900.0000000000000000
"1608";4;8400.0000000000000000
"1609";1;1000.0000000000000000
"1609";2;3500.0000000000000000
"1609";3;6000.0000000000000000
"1609";4;8500.0000000000000000
"1610";1;1100.0000000000000000
"1610";2;3600.0000000000000000
"1610";3;6100.0000000000000000
"1610";4;8600.0000000000000000
"1611";1;1200.0000000000000000
"1611";2;3700.0000000000000000
"1611";3;6200.0000000000000000
"1611";4;8700.0000000000000000
"1612";1;1300.0000000000000000
"1612";2;3800.0000000000000000
"1612";3;6300.0000000000000000
"1612";4;8800.0000000000000000
"1613";1;1400.0000000000000000
"1613";2;3900.0000000000000000
"1613";3;6400.0000000000000000
"1613";4;8900.0000000000000000
"1614";1;1500.0000000000000000
"1614";2;4000.0000000000000000
"1614";3;6500.0000000000000000
"1614";4;9000.0000000000000000
"1615";1;1600.0000000000000000
"1615";2;4100.0000000000000000
"1615";3;6600.0000000000000000
"1615";4;9100.0000000000000000
"1616";1;1700.0000000000000000
"1616";2;4200.0000000000000000
"1616";3;6700.0000000000000000
"1616";4;9200.0000000000000000
"1617";1;1800.0000000000000000
"1617";2;4300.0000000000000000
"1617";3;6800.0000000000000000
"1617";4;9300.0000000000000000
"1618";1;1900.0000000000000000
"1618";2;4400.0000000000000000
"1618";3;6900.0000000000000000
"1618";4;9400.0000000000000000
"1619";1;2000.0000000000000000
"1619";2;4500.0000000000000000
"1619";3;7000.0000000000000000
"1619";4;9500.0000000000000000
"1620";1;2100.0000000000000000
"1620";2;4600.0000000000000000
"1620";3;7100.0000000000000000
"1620";4;9600.0000000000000000
"1621";1;2200.0000000000000000
"1621";2;4700.0000000000000000
"1621";3;7200.0000000000000000
"1621";4;9700.0000000000000000
"1622";1;2300.0000000000000000
"1622";2;4800.0000000000000000
"1622";3;7300.0000000000000000
"1622";4;9800.0000000000000000
"1623";1;2400.0000000000000000
"1623";2;4900.0000000000000000
"1623";3;7400.0000000000000000
"1623";4;9900.0000000000000000
"1624";1;2500.0000000000000000
"1624";2;5000.0000000000000000
"1624";3;7500.0000000000000000
"1624";4;10000.0000000000000000
"1701";1789;300.0000000000000000
"1707";1799;687.5500000000000000
"1708";1798;30.0000000000000000
"1709";1777;50.0000000000000000
"1710";1788;250.0000000000000000
"1792";199;500.0000000000000000
"1797";197;250.0000000000000000
"1808";195;5.0000000000000000
"2692";26901;198.8575000000000000
"2794";27100;160.1150000000000000
"2918";703;2612.2300000000000000
"3075";198;2500.0000000000000000
"3534";35400;423.7300000000000000
"3536";35600;2701.3333333333333333
"3928";997790;100.0000000000000000
"5874";700;12.4500000000000000
"7134";321;20.0000000000000000
*/
-- 18) CONSULTAS COM AGRUPAMENTOS, JUNÇÕES E FUNÇÕES AGREGADAS
	-- (a) Listar parar funcionários admitidos no último ano a quantidade de dependentes que possuem
SELECT f.num_funcional,count(d.*) FROM funcionario f LEFT JOIN dependentes d ON f.num_funcional = d.funcionario WHERE f.data_admissao >= CURRENT_DATE - INTERVAL '1 year' GROUP BY f.num_funcional ORDER BY count DESC;
/*
1673;3
1669;3
1671;3
1674;3
1672;3
1670;3
1668;3
1649;2
1103;2
1643;2
1101;2
1100;2
1102;2
1105;2
1647;2
1646;2
1645;2
1104;2
1648;2
1644;2
1621;1
1721;1
1618;1
1620;1
1720;1
4;1
1622;1
1624;1
1619;1
1623;1
1694;0
1699;0
1696;0
1693;0
1697;0
1695;0
1698;0
*/
	-- (b) Listar o número funcional de cada funcionário juntamente com o número de dependentes que eles possuem
	       --- caso o funcionário não possua dependetes ele deve aparecer na resposta com 0 dependentes
SELECT f.num_funcional,count(d.*) FROM funcionario f LEFT JOIN dependentes d ON f.num_funcional = d.funcionario GROUP BY f.num_funcional ORDER BY count DESC;
/*
1653;3
1669;3
1658;3
1664;3
1671;3
1667;3
1659;3
1670;3
1674;3
1657;3
1656;3
1654;3
1661;3
1665;3
1672;3
1660;3
1668;3
1666;3
1673;3
1662;3
1652;3
1655;3
1651;3
1663;3
1627;2
1636;2
1631;2
1629;2
1644;2
1643;2
1640;2
1105;2
1648;2
1625;2
1641;2
1634;2
1102;2
802;2
1638;2
1646;2
1104;2
1630;2
1101;2
1632;2
1103;2
1637;2
1635;2
1100;2
1639;2
1650;2
1626;2
1645;2
1642;2
1628;2
1649;2
1633;2
1647;2
1619;1
1721;1
903;1
103;1
1301;1
801;1
1618;1
1728;1
4;1
700;1
1603;1
1614;1
101;1
1624;1
1303;1
1612;1
800;1
1;1
1601;1
1620;1
1720;1
1617;1
1605;1
1600;1
1611;1
1607;1
702;1
1729;1
5;1
1623;1
1615;1
3;1
901;1
1613;1
1304;1
703;1
1616;1
902;1
1300;1
900;1
1722;1
1609;1
1621;1
701;1
704;1
1604;1
1608;1
1602;1
100;1
804;1
1302;1
1610;1
104;1
102;1
1622;1
1606;1
2;1
904;1
1692;0
1681;0
807;0
1699;0
1685;0
1690;0
814;0
813;0
810;0
808;0
1680;0
803;0
812;0
1695;0
809;0
805;0
1693;0
1679;0
1677;0
1688;0
1686;0
1697;0
1684;0
1694;0
1683;0
806;0
1691;0
1678;0
1689;0
1676;0
1687;0
1698;0
811;0
1696;0
1675;0
1682;0
*/
    -- (c) Listar para cada conta a quantidade de operações que foram realizadas na mesma. Caso a conta
	       --- não possua operação associada, escrever '<sem operação>'
SELECT c.cod_agencia,c.numero,COALESCE(count(o.*)::text,'<sem operação>') FROM conta c LEFT JOIN operacao o ON c.cod_agencia = o.cod_agencia AND c.numero = o.numero_conta GROUP BY c.cod_agencia,c.numero;
/*
"3536";35607;"<sem operação>"
"0128";456;" 1"
"1618";3;" 1"
"3536";35610;"<sem operação>"
"1100";1101;" 1"
"1484";14805;"<sem operação>"
"2692";26907;"<sem operação>"
"1609";1;" 1"
"1104";1101;" 1"
"1604";3;" 1"
"1621";2;" 1"
"1710";1788;" 1"
"1484";14810;"<sem operação>"
"1608";2;" 1"
"1101";1104;" 1"
"1301";1;" 1"
"1484";14808;"<sem operação>"
"1484";14800;" 1"
"1615";4;" 1"
"1620";4;" 1"
"3534";35410;"<sem operação>"
"2692";26906;"<sem operação>"
"1300";1;" 1"
"1619";2;" 1"
"1601";1;" 1"
"1624";1;" 1"
"1617";2;" 1"
"1622";3;" 1"
"2794";27108;"<sem operação>"
"1611";1;" 1"
"3075";198;" 1"
"1102";1101;" 1"
"1606";1;" 1"
"2794";27102;"<sem operação>"
"1602";2;" 1"
"1612";2;" 1"
"1101";1100;" 1"
"3536";35606;"<sem operação>"
"1600";1;" 1"
"1607";1;" 1"
"1623";4;" 1"
"1613";2;" 1"
"3536";35611;"<sem operação>"
"2692";26900;"<sem operação>"
"3536";35603;"<sem operação>"
"1610";3;" 1"
"1603";1;" 1"
"3534";35400;" 2"
"1232";987;" 1"
"1221";704;" 1"
"3534";35405;"<sem operação>"
"1605";1;" 1"
"1614";2;" 1"
"1103";1102;" 1"
"3534";35407;"<sem operação>"
"1616";3;" 1"
"2794";27105;"<sem operação>"
"3534";35404;"<sem operação>"
"2918";703;" 1"
"1001";701;" 1"
"1103";1104;" 1"
"1602";3;" 1"
"1484";14804;"<sem operação>"
"1600";4;" 1"
"0411";789;" 1"
"1612";3;" 1"
"2692";26901;" 4"
"1623";1;" 1"
"1607";4;" 1"
"1303";1;" 1"
"1102";1103;" 1"
"2794";27101;"<sem operação>"
"1606";4;" 1"
"1613";3;" 1"
"1610";2;" 1"
"1708";1798;" 1"
"2692";26910;"<sem operação>"
"1614";3;" 1"
"1609";3;" 1"
"3534";35403;"<sem operação>"
"1616";2;" 1"
"0775";196;" 1"
"1604";1;" 1"
"1603";4;" 1"
"3536";35602;"<sem operação>"
"1101";1103;" 1"
"1104";1102;" 1"
"1605";4;" 1"
"3536";35605;"<sem operação>"
"1618";2;" 1"
"1603";3;" 1"
"2692";26904;"<sem operação>"
"1605";3;" 1"
"3534";35408;"<sem operação>"
"1101";1102;" 1"
"1103";1101;" 1"
"1104";1103;" 1"
"2794";27100;" 2"
"2794";27103;"<sem operação>"
"2794";27104;"<sem operação>"
"1484";14811;"<sem operação>"
"1100";1103;" 1"
"1701";1789;" 1"
"3536";35601;"<sem operação>"
"1484";14812;"<sem operação>"
"1616";1;" 1"
"1609";4;" 1"
"1621";3;" 1"
"1604";2;" 1"
"1614";4;" 1"
"3534";35409;"<sem operação>"
"1606";3;" 1"
"1608";3;" 1"
"1613";4;" 1"
"1102";1102;" 1"
"1611";4;" 1"
"1323";908837;" 1"
"1103";1100;" 1"
"2794";27109;"<sem operação>"
"3534";35406;"<sem operação>"
"1623";2;" 1"
"1601";4;" 1"
"1624";4;" 1"
"3536";35600;" 3"
"1600";3;" 1"
"1484";14806;"<sem operação>"
"1612";4;" 1"
"1607";3;" 1"
"1615";1;" 1"
"1620";1;" 1"
"1619";3;" 1"
"1709";1777;" 1"
"1622";2;" 1"
"1617";3;" 1"
"1610";1;" 1"
"1602";4;" 1"
"3928";997790;" 1"
"3536";35608;"<sem operação>"
"2692";26908;"<sem operação>"
"1221";702;" 1"
"1603";2;" 1"
"1614";1;" 1"
"1605";2;" 1"
"2794";27107;"<sem operação>"
"1102";1104;" 1"
"1616";4;" 1"
"3534";35411;"<sem operação>"
"1484";14802;"<sem operação>"
"1103";1103;" 1"
"3536";35609;"<sem operação>"
"3534";35401;"<sem operação>"
"1100";1100;" 1"
"1606";2;" 1"
"2794";27110;"<sem operação>"
"1602";1;" 1"
"1610";4;" 1"
"1612";1;" 1"
"1484";14803;"<sem operação>"
"1623";3;" 1"
"1600";2;" 1"
"1607";2;" 1"
"2692";26909;"<sem operação>"
"1613";1;" 1"
"0095";123;" 1"
"1104";1100;" 1"
"1302";1;" 1"
"1608";1;" 1"
"1622";4;" 1"
"2692";26903;"<sem operação>"
"1100";1104;" 1"
"3536";35604;"<sem operação>"
"1484";14807;"<sem operação>"
"1104";1104;" 1"
"1619";1;" 1"
"1615";3;" 1"
"1620";3;" 1"
"1601";2;" 1"
"1624";2;" 1"
"1484";14801;"<sem operação>"
"1617";1;" 1"
"1611";2;" 1"
"1604";4;" 1"
"1102";1100;" 1"
"1101";1101;" 1"
"0743";899769;" 1"
"1484";14809;"<sem operação>"
"1609";2;" 1"
"7134";321;" 1"
"5874";700;" 1"
"1618";4;" 1"
"1324";993005;" 1"
"2794";27106;"<sem operação>"
"1621";1;" 1"
"0706";993997;" 1"
"1617";4;" 1"
"1619";4;" 1"
"1797";197;" 1"
"3534";35402;"<sem operação>"
"1601";3;" 1"
"1624";3;" 1"
"2692";26902;"<sem operação>"
"1615";2;" 1"
"1620";2;" 1"
"1808";195;" 1"
"1622";1;" 1"
"1608";4;" 1"
"1611";3;" 1"
"2692";26911;"<sem operação>"
"1100";1102;" 1"
"1621";4;" 1"
"1707";1799;" 1"
"1618";1;" 1"
"1304";1;" 1"
"2692";26905;"<sem operação>"
"1792";199;" 1"
*/
    -- (d) Listar o número funcional de cada funcionário lotados em agências do 'RJ' juntamente com o número 
	       -- de dependentes que eles possuem caso o funcionário não possua dependetes ele deve 
		   -- aparecer na resposta com 0 dependentes
SELECT f.num_funcional,count(d.*) FROM funcionario f LEFT JOIN dependentes d ON f.num_funcional = d.funcionario JOIN agencia a ON f.agencia = a.codigo WHERE UPPER(a.estado) = 'RJ' GROUP BY f.num_funcional;
/*
102;1
100;1
101;1
104;1
103;1
*/
	-- (e) Listar a quantidade de supervisores de cada agência do estado de 'MG'
SELECT a.codigo,count(s.*) FROM funcionario f JOIN funcionario s ON f.supervisor = s.num_funcional RIGHT JOIN agencia a ON s.agencia = a.codigo WHERE UPPER(a.estado) = 'MG' GROUP BY a.codigo;
/*
"5874";1
"1001";1
"3139";0
"1221";1
"2918";2
*/
		-- Listar para cada agência a quantidade de gerentes (somente para as agência que possuem gerentes)
SELECT a.codigo,count(DISTINCT g.num_funcional) FROM cliente c JOIN funcionario g ON c.gerente = g.num_funcional JOIN agencia a ON g.agencia = a.codigo GROUP BY a.codigo;
/*
"0095";1
"0128";1
"0411";1
"0706";1
"0743";1
"1001";1
"1100";1
"1101";1
"1102";1
"1103";1
"1104";2
"1221";1
"1232";1
"1300";1
"1301";1
"1302";1
"1303";1
"1304";1
"1323";1
"1324";1
"1484";3
"1600";4
"1601";4
"1602";4
"1603";4
"1604";4
"1605";4
"1606";4
"1607";4
"1608";4
"1609";4
"1610";4
"1611";4
"1612";4
"1613";4
"1614";4
"1615";4
"1616";4
"1617";4
"1618";4
"1619";4
"1620";4
"1621";4
"1622";4
"1623";4
"1624";4
"1701";1
"1707";1
"1708";1
"1709";1
"1710";1
"1808";1
"2692";3
"2794";3
"2918";1
"3075";1
"3534";3
"3536";3
"3928";1
"5874";1
"7134";1
*/
    -- (f)
		-- Listar para cada agência a quantidade de gerentes, incluir as agências sem gerentes na resposta, 
		   -- mostrando zero na quantidade
SELECT a.codigo,count(DISTINCT g.num_funcional) FROM cliente c JOIN funcionario g ON c.gerente = g.num_funcional RIGHT JOIN agencia a ON g.agencia = a.codigo GROUP BY a.codigo;
/*
"0095";1
"0128";1
"0411";1
"0706";1
"0743";1
"0775";0
"1001";1
"1100";1
"1101";1
"1102";1
"1103";1
"1104";2
"1221";1
"1232";1
"1300";1
"1301";1
"1302";1
"1303";1
"1304";1
"1323";1
"1324";1
"1484";3
"1600";4
"1601";4
"1602";4
"1603";4
"1604";4
"1605";4
"1606";4
"1607";4
"1608";4
"1609";4
"1610";4
"1611";4
"1612";4
"1613";4
"1614";4
"1615";4
"1616";4
"1617";4
"1618";4
"1619";4
"1620";4
"1621";4
"1622";4
"1623";4
"1624";4
"1701";1
"1707";1
"1708";1
"1709";1
"1710";1
"1792";0
"1797";0
"1808";1
"2692";3
"2794";3
"2918";1
"3075";1
"3139";0
"3534";3
"3536";3
"3928";1
"5874";1
"7134";1
*/
-- 19) CONSULTAS COM AGRUPAMENTOS E QUE LISTAM ATRIBUTOS NÃO AGRUPADOS.
    -->> Se o agrupamento for feito utilizando um atributo que é PK, pode-se mostrar no resultado da consulta
	  -- os atributos da mesma tabela e que não foram agrupados.
    -- (a) Listar a quantidade de funcionários por agência (mostrar o nome da agência e o número de funcionários)
SELECT a.nome,count(f.*) FROM funcionario f RIGHT JOIN agencia a ON f.agencia = a.codigo GROUP BY a.codigo;
/*
"Bairro Anchieta";3
"Banco do Brasil S.A. - Nacoes Unidas";1
"BANCO DO BRASIL S.A.-ANHANGABAU-SAO PAULO";4
"Bairro Boqueirao";3
"Gurupi 1";1
"Halfeld";0
"Bernardo Sayao 1";2
"Agência Angelica";1
"Palmas 1";1
"Caixa Econômica";1
"BANCO DO BRASIL S.A.-GALERIA OLIDO";4
"BANCO DO BRASIL S.A.-PALACIO MAUA";4
"BANCO DO BRASIL S.A.-BOULEVARD SAO JOAO";4
"Agência Amambai";1
"Banco do Brasil S.A. - Porto Velho";1
"BANCO DO BRASIL S.A.-PODER JUDICIARIO";4
"Banco do Brasil S.A. - Avenida Amazonas";1
"BANCO DO BRASIL S.A.-BARAO DE DUPRAT";4
"BANCO DO BRASIL S.A.-ESTILO JOAO MENDES";4
"Agência 0054";1
"BANCO DO BRASIL S.A.-PCA.DOM JOSE GASPAR";4
"Agência Aquidauana";1
"BANCO DO BRASIL S.A.-GECEX SAO PAULO II";4
"BANCO DO BRASIL S.A.-SAO PAULO";4
"Itaú";1
"BANCO DO BRASIL S.A.-PREVIDENCIA";4
"BANCO DO BRASIL S.A.-GOVERNO SAO PAULO";4
"Agência 0300";1
"001-0775 R D.CAXIAS-TERESOPOLIS-RJ";1
"BANCO DO BRASIL S.A.-R.DA QUITANDA-S.PAULO";4
"Avenida João Naves";1
"Agência 0987";1
"Banco do Brasil S.A. - Nova Porto Velho";1
"BANCO DO BRASIL S.A.-ESTILO SAO JOAO";4
"Avenida Floriano Peixoto";2
"BANCO DO BRASIL S.A.-MINISTERIO FAZENDA";4
"Gurupi 2";1
"Carlos Gomes";3
"banco do brasil";1
"BANCO DO BRASIL S.A.-EDIFICIO ITALIA";4
"001-1792 SHOP METROPOLITANO-RIO-RJ";1
"001-1797 SELECT BOTAFOGO-RJ";1
"BANCO DO BRASIL S.A.-EMPR.CENTRO S.PAULO";4
"Dr.Mariano Da Rocha";3
"BANCO DO BRASIL S.A.-CATEDRAL DA SE";4
"Agência Aparecida Do Taboado";1
"Agência Anaurilandia";1
"001-1808 SELECT CONDE DE BONFIM-RJ";1
"Santader";1
"Agência 0171";1
"BANCO DO BRASIL S.A.-XAVIER DE TOLEDO";4
"BANCO DO BRASIL S.A.-SETE DE ABRIL";4
"Banco do Brasil S.A. - Jatuarana";1
"Bento Brasil";3
"BANCO DO BRASIL S.A.-ESTILO SAO PAULO";4
"BANCO DO BRASIL S.A.-24 DE MAIO";4
"HSBC";1
"BANCO DO BRASIL S.A.-PRACA DO PATRIARCA";4
"BANCO DO BRASIL S.A.-PALACIO DA JUSTICA";4
"Araguaina 1";1
"001-3075 PLAT.CORPORATE M/N AV.RIO BRANCO";1
"Bairro Martins";1
"Carijos";1
"Agência 0154";1
"BANCO DO BRASIL S.A.-R.BOA VISTA-S.PAULO";4
*/
	-- (b) Para os funcionários que possuem dependentes, listar o nome de cada funcionário 
	       --juntamente com o número de dependentes que eles possuem
SELECT f.nome,count(d.*) FROM funcionario f JOIN dependentes d ON f.num_funcional = d.funcionario GROUP BY f.num_funcional;
/*
"Miguel Ricardo Costa";1
"Laurinda Dutra";3
"Maria Aparecida";2
"Cristiane Dias";1
"Potira Caminha";3
"Nicolas Breno Luan Moura";1
"Flávia Meirelles";2
"Carlos Sousa";1
"Luiz";2
"Delfina Ornelas";2
"Rhaniel";1
"Epaminondas Marcondes";2
"Cesar Naves";1
"Camila Almeida";1
"Ricardo Filho";1
"Olga Jucá";3
"Johnata Ferreira";1
"Joao da Silva";1
"Eduardo Palmeira";2
"Nádia Monforte";3
"Alcides Zagalo";1
"Gaspar Tavera";2
"Dinarte Torrado";2
"Guido Morais";2
"Belmira Rodrigues";1
"Diamantino Pozas";2
"Marilda Toledo";3
"Leonor Goncalves";1
"Célia Lobato";1
"Délio Grangeia";2
"Sandro";1
"Baltasar Otero";1
"Antonio Oliveira";1
"Thiago Moreira Borges";1
"Adélia Barroqueiro";1
"Fernão Ataí";2
"Plínio Moita";3
"Natália Reyes";3
"Jose Roberto";2
"Janaína Paranaguá";3
"Celso Vasconcellos";1
"Lucas Rezende";1
"Caetano Louzada";1
"Aluísio Herrera";1
"Adão Casalinho";1
"Arminda Carneiro";1
"Feliciana Ventura";2
"Gonçalo Carvalhaes";2
"Noémia Cavadas";3
"Dorindo Portela";2
"Amílcar Soeiro";1
"Joaquim Nascimento";1
"Maria da Silva";1
"Pedro Valido";3
"Melissa Chousa";3
"Jose Roberto";1
"Carlos";2
"Cosme Palha";1
"Ordonho Lira";3
"Caio";2
"Palmira Garcés";3
"Bernardina Pereira";1
"Jacinto Garcez";2
"Daniel Dias Alves";1
"Cauê Davi Enrico da Silva";1
"Flamínia Vega";2
"Jorgina Anlicoara";3
"Barnabé Cesário";1
"Ildefonso Castello Branco";2
"Augusto";1
"Francisco da Silva";1
"Emílio García";2
"Bernardo Vellozo";1
"Julio Igor Cauã Campos";1
"Arthur";1
"Lionel Messi";2
"Lorenzo Breno Cauê Almeida";1
"Paulo Roberto";1
"Apoena Villar";1
"Laurinda Lima";3
"Clarisse Espírito Santo";1
"Rafael";2
"Julieta Villas Boas";3
"Denise Taperebá";2
"Jose da Costa";1
"Jair das Couves";1
"Aluísio Gentil";1
"Anhangüera Silva";1
"Hipólito Quadros";2
"Fábio Pamplona";2
"Alarico Alancastro";1
"Liedson Domingos";3
"﻿Brenda Melo";1
"Flavia de Almeida";1
"Marco Mortágua";3
"Jean";1
"Eloi Amarante";2
"Felícia Quinzeiro";2
"Eva Quinterno";2
"Arcidres Fonseca";1
"Olavo Negromonte";3
"Liliana Brites";3
"Emiliano Gracia";2
"Nicolau Travassos";3
"Filena Vilhena";2
"Paulo Barbosa";1
"Luiz Cunha";1
"Claudemira Villela";1
"Nazaré Arantes";3
"Alvito Cachão";1
"Domingos Antas";2
"Fabricio Ismael";1
"Mem Mangueira";3
"Paulino Brião";3
"Caubi Villar";1
*/
	-- (c) Listar o nome de cada agência em que trabalham funcionários juntamente com a data de admissão mais recente
SELECT a.nome,MAX(f.data_admissao) FROM funcionario f JOIN agencia a ON f.agencia = a.codigo GROUP BY a.codigo ORDER BY a.codigo;
/*
"banco do brasil";"2010-07-23"
"HSBC";"2008-09-12"
"Caixa Econômica";"2007-04-12"
"Agência Aparecida Do Taboado";"2002-03-08"
"Agência Amambai";"2015-02-12"
"001-0775 R D.CAXIAS-TERESOPOLIS-RJ";"2008-02-15"
"Bairro Martins";"2008-04-05"
"Gurupi 1";"2016-10-06"
"Gurupi 2";"2016-10-06"
"Palmas 1";"2016-10-06"
"Araguaina 1";"2016-10-06"
"Bernardo Sayao 1";"2016-10-06"
"Carijos";"2009-03-12"
"Santader";"2005-02-12"
"Banco do Brasil S.A. - Avenida Amazonas";"1991-01-01"
"Banco do Brasil S.A. - Porto Velho";"1992-02-02"
"Banco do Brasil S.A. - Jatuarana";"1993-03-03"
"Banco do Brasil S.A. - Nacoes Unidas";"1994-04-04"
"Banco do Brasil S.A. - Nova Porto Velho";"1995-05-05"
"Agência Angelica";"2012-04-05"
"Agência Aquidauana";"1992-10-02"
"Dr.Mariano Da Rocha";"2004-05-01"
"BANCO DO BRASIL S.A.-SAO PAULO";"2011-06-03"
"BANCO DO BRASIL S.A.-BARAO DE DUPRAT";"2011-06-27"
"BANCO DO BRASIL S.A.-SETE DE ABRIL";"2011-07-21"
"BANCO DO BRASIL S.A.-GOVERNO SAO PAULO";"2012-04-27"
"BANCO DO BRASIL S.A.-MINISTERIO FAZENDA";"2012-10-31"
"BANCO DO BRASIL S.A.-PREVIDENCIA";"2012-12-28"
"BANCO DO BRASIL S.A.-PCA.DOM JOSE GASPAR";"2013-02-07"
"BANCO DO BRASIL S.A.-GECEX SAO PAULO II";"2013-05-03"
"BANCO DO BRASIL S.A.-24 DE MAIO";"2013-07-09"
"BANCO DO BRASIL S.A.-BOULEVARD SAO JOAO";"2013-07-17"
"BANCO DO BRASIL S.A.-EMPR.CENTRO S.PAULO";"2013-07-29"
"BANCO DO BRASIL S.A.-PODER JUDICIARIO";"2013-09-24"
"BANCO DO BRASIL S.A.-XAVIER DE TOLEDO";"2013-11-11"
"BANCO DO BRASIL S.A.-ESTILO SAO PAULO";"2014-01-13"
"BANCO DO BRASIL S.A.-CATEDRAL DA SE";"2014-04-18"
"BANCO DO BRASIL S.A.-GALERIA OLIDO";"2015-02-25"
"BANCO DO BRASIL S.A.-EDIFICIO ITALIA";"2015-04-22"
"BANCO DO BRASIL S.A.-PRACA DO PATRIARCA";"2015-06-03"
"BANCO DO BRASIL S.A.-ESTILO SAO JOAO";"2015-12-04"
"BANCO DO BRASIL S.A.-PALACIO DA JUSTICA";"2016-01-08"
"BANCO DO BRASIL S.A.-PALACIO MAUA";"2016-01-11"
"BANCO DO BRASIL S.A.-R.BOA VISTA-S.PAULO";"2016-03-15"
"BANCO DO BRASIL S.A.-R.DA QUITANDA-S.PAULO";"2016-05-24"
"BANCO DO BRASIL S.A.-ANHANGABAU-SAO PAULO";"2016-07-21"
"BANCO DO BRASIL S.A.-ESTILO JOAO MENDES";"2016-08-05"
"Agência 0171";"2016-01-08"
"Agência 0054";"2016-08-09"
"Agência 0987";"2015-03-01"
"Agência 0300";"2014-02-02"
"Agência 0154";"2015-01-12"
"001-1792 SHOP METROPOLITANO-RIO-RJ";"2003-05-14"
"001-1797 SELECT BOTAFOGO-RJ";"1996-05-04"
"001-1808 SELECT CONDE DE BONFIM-RJ";"2009-11-11"
"Bento Brasil";"2004-05-01"
"Bairro Anchieta";"2004-05-01"
"Avenida Floriano Peixoto";"2011-09-01"
"001-3075 PLAT.CORPORATE M/N AV.RIO BRANCO";"2009-06-14"
"Bairro Boqueirao";"2004-05-01"
"Carlos Gomes";"2004-05-01"
"Agência Anaurilandia";"2016-03-12"
"Avenida João Naves";"2008-04-06"
"Itaú";"2006-06-12"
*/
	-- (d) Listar todas as contas que efeturam operações. Mostrar jutamente o maior valor de operação da conta
SELECT cod_agencia,numero_conta,MAX(valor) FROM operacao GROUP BY cod_agencia,numero_conta;

/*
"0128";456;5.00
"1618";3;6900.00
"1100";1101;123.00
"1609";1;1000.00
"1104";1101;113.00
"1604";3;5500.00
"1621";2;4700.00
"1710";1788;250.00
"1608";2;3400.00
"1101";1104;75.00
"1301";1;1000000000.00
"1484";14800;300.23
"1615";4;9100.00
"1620";4;9600.00
"1300";1;1000000000.00
"1619";2;4500.00
"1601";1;200.00
"1624";1;2500.00
"1617";2;4300.00
"1622";3;7300.00
"1611";1;1200.00
"3075";198;2500.00
"1102";1101;23.40
"1608";1;900.00
"1622";4;9800.00
"1606";1;700.00
"1602";2;2800.00
"1612";2;3800.00
"1100";1104;42.75
"1101";1100;540.00
"1600";1;100.00
"1104";1104;15.00
"1619";1;2000.00
"1615";3;6600.00
"1620";3;7100.00
"1607";1;800.00
"1601";2;2700.00
"1624";2;5000.00
"1623";4;9900.00
"1617";1;1800.00
"1613";2;3900.00
"1611";2;3700.00
"1610";3;6100.00
"1603";1;400.00
"1604";4;8000.00
"3534";35400;547.23
"1232";987;3000.00
"1221";704;212.50
"1605";1;600.00
"1614";2;4000.00
"1102";1100;15.00
"1101";1101;25.00
"1103";1102;250.00
"0743";899769;200.00
"1609";2;3500.00
"7134";321;20.00
"1616";3;6700.00
"5874";700;12.45
"1618";4;9400.00
"1324";993005;2700.00
"1621";1;2200.00
"2918";703;2612.23
"1001";701;10212.00
"1103";1104;950.00
"0706";993997;1200.00
"1617";4;9300.00
"1602";3;5300.00
"1600";4;7600.00
"0411";789;40.00
"1612";3;6300.00
"2692";26901;320.00
"1623";1;2400.00
"1607";4;8300.00
"1303";1;1000000000.00
"1619";4;9500.00
"1797";197;250.00
"1102";1103;717.00
"1601";3;5200.00
"1624";3;7500.00
"1615";2;4100.00
"1620";2;4600.00
"1808";195;5.00
"1606";4;8200.00
"1622";1;2300.00
"1613";3;6400.00
"1608";4;8400.00
"1610";2;3600.00
"1611";3;6200.00
"1100";1102;7.26
"1621";4;9700.00
"1707";1799;687.55
"1618";1;1900.00
"1304";1;1000000000.00
"1708";1798;30.00
"1614";3;6500.00
"1792";199;500.00
"1609";3;6000.00
"1616";2;4200.00
"0775";196;3500.00
"1604";1;500.00
"1603";4;7900.00
"1101";1103;50.00
"1104";1102;15.00
"1605";4;8100.00
"1618";2;4400.00
"1603";3;5400.00
"1605";3;5600.00
"1101";1102;15.00
"1103";1101;15.00
"1104";1103;75.00
"2794";27100;300.23
"1100";1103;53.23
"1701";1789;300.00
"1616";1;1700.00
"1609";4;8500.00
"1621";3;7200.00
"1604";2;3000.00
"1614";4;9000.00
"1606";3;5700.00
"1608";3;5900.00
"1613";4;8900.00
"1102";1102;27.85
"1611";4;8700.00
"1323";908837;600.00
"1103";1100;50.00
"1623";2;4900.00
"1601";4;7700.00
"1624";4;10000.00
"3536";35600;7430.00
"1600";3;5100.00
"1612";4;8800.00
"1607";3;5800.00
"1615";1;1600.00
"1620";1;2100.00
"1619";3;7000.00
"1709";1777;50.00
"1622";2;4800.00
"1617";3;6800.00
"1610";1;1100.00
"1602";4;7800.00
"3928";997790;100.00
"1221";702;412.00
"1603";2;2900.00
"1614";1;1500.00
"1605";2;3100.00
"1102";1104;15.00
"1616";4;9200.00
"1103";1103;15.00
"1100";1100;15.00
"1606";2;3200.00
"1602";1;300.00
"1610";4;8600.00
"1612";1;1300.00
"1623";3;7400.00
"1600";2;2600.00
"1607";2;3300.00
"1613";1;1400.00
"0095";123;10.00
"1104";1100;15.00
"1302";1;1000000000.00
*/
	-- (e) Listar para cada conta o saldo e a quantidade de clientes que a possui.
SELECT c.cod_agencia,c.numero,c.saldo,count(cc.*) FROM conta c LEFT JOIN clienteconta cc ON c.cod_agencia = cc.cod_agencia AND c.numero = cc.numero_conta GROUP BY c.cod_agencia,c.numero;
/*
"3536";35607;2215.52;1
"0128";456;100.00;1
"1618";3;6900.00;1
"3536";35610;154574.12;1
"1100";1101;3250.00;1
"1484";14805;14565.32;1
"2692";26907;15479.29;1
"1609";1;1000.00;1
"1104";1101;3250.00;1
"1604";3;5500.00;1
"1621";2;4700.00;1
"1710";1788;322.12;1
"1484";14810;2316.26;1
"1608";2;3400.00;1
"1101";1104;3250.00;1
"1301";1;1000000000.00;1
"1484";14808;454.52;1
"1484";14800;321584.00;1
"1615";4;9100.00;1
"1620";4;9600.00;1
"3534";35410;112.23;1
"2692";26906;154574.12;1
"1300";1;1000000000.00;1
"1619";2;4500.00;1
"1601";1;200.00;1
"1624";1;2500.00;1
"1617";2;4300.00;1
"1622";3;7300.00;1
"2794";27108;154684.32;1
"1611";1;1200.00;1
"3075";198;6675.36;1
"1102";1101;3250.00;1
"1606";1;700.00;1
"2794";27102;15479.21;1
"1602";2;2800.00;1
"1612";2;3800.00;1
"1101";1100;3250.00;1
"3536";35606;2316.26;1
"1600";1;100.00;1
"1607";1;800.00;1
"1623";4;9900.00;1
"1613";2;3900.00;1
"3536";35611;15479.20;1
"2692";26900;454.52;1
"3536";35603;14563.34;1
"1610";3;6100.00;1
"1603";1;400.00;1
"3534";35400;154547.66;1
"1232";987;982209.95;1
"1221";704;120005555.99;1
"3534";35405;154684.32;1
"1605";1;600.00;1
"1614";2;4000.00;1
"1103";1102;3250.00;1
"3534";35407;21256464.14;1
"1616";3;6700.00;1
"2794";27105;152457.32;1
"3534";35404;321584.10;1
"2918";703;99999999.99;1
"1001";701;1000012000.32;1
"1103";1104;3250.00;1
"1602";3;5300.00;1
"1484";14804;16148.14;1
"1600";4;7600.00;1
"0411";789;2000.00;1
"1612";3;6300.00;1
"2692";26901;18466.58;1
"1623";1;2400.00;1
"1607";4;8300.00;1
"1303";1;1000000000.00;1
"1102";1103;3250.00;1
"2794";27101;154574.12;1
"1606";4;8200.00;1
"1613";3;6400.00;1
"1610";2;3600.00;1
"1708";1798;500.98;1
"2692";26910;152457.32;1
"1614";3;6500.00;1
"1609";3;6000.00;1
"3534";35403;11546.15;1
"1616";2;4200.00;1
"0775";196;36.39;1
"1604";1;500.00;1
"1603";4;7900.00;1
"3536";35602;112.23;1
"1101";1103;3250.00;1
"1104";1102;3250.00;1
"1605";4;8100.00;1
"3536";35605;18466.58;1
"1618";2;4400.00;1
"1603";3;5400.00;1
"2692";26904;23215936.36;1
"1605";3;5600.00;1
"3534";35408;16148.14;1
"1101";1102;3250.00;1
"1103";1101;3250.00;1
"1104";1103;3250.00;1
"2794";27100;123.45;1
"2794";27103;154547.66;1
"2794";27104;1212121.45;1
"1484";14811;2215.52;1
"1100";1103;3250.00;1
"1701";1789;400.00;1
"3536";35601;14565.32;1
"1484";14812;23215936.36;1
"1616";1;1700.00;1
"1609";4;8500.00;1
"1621";3;7200.00;1
"1604";2;3000.00;1
"1614";4;9000.00;1
"3534";35409;14565.32;1
"1606";3;5700.00;1
"1608";3;5900.00;1
"1613";4;8900.00;1
"1102";1102;3250.00;1
"1611";4;8700.00;1
"1323";908837;5239.00;1
"1103";1100;3250.00;1
"2794";27109;78263.32;1
"3534";35406;78263.32;1
"1623";2;4900.00;1
"1601";4;7700.00;1
"1624";4;10000.00;1
"3536";35600;16148.14;1
"1600";3;5100.00;1
"1484";14806;112.23;1
"1612";4;8800.00;1
"1607";3;5800.00;1
"1615";1;1600.00;1
"1620";1;2100.00;1
"1619";3;7000.00;1
"1709";1777;798.22;1
"1622";2;4800.00;1
"1617";3;6800.00;1
"1610";1;1100.00;1
"1602";4;7800.00;1
"3928";997790;873.40;1
"3536";35608;23215936.36;1
"2692";26908;154547.66;1
"1221";702;10000000.55;1
"1603";2;2900.00;1
"1614";1;1500.00;1
"1605";2;3100.00;1
"2794";27107;321584.00;1
"1102";1104;3250.00;1
"1616";4;9200.00;1
"3534";35411;14563.34;1
"1484";14802;78263.32;1
"1103";1103;3250.00;1
"3536";35609;123.45;1
"3534";35401;1212121.45;1
"1100";1100;3250.00;1
"1606";2;3200.00;1
"2794";27110;21256464.14;1
"1602";1;300.00;1
"1610";4;8600.00;1
"1612";1;1300.00;1
"1484";14803;21256464.14;1
"1623";3;7400.00;1
"1600";2;2600.00;1
"1607";2;3300.00;1
"2692";26909;1212121.45;1
"1613";1;1400.00;1
"0095";123;7000.00;1
"1104";1100;3250.00;1
"1302";1;1000000000.00;1
"1608";1;900.00;1
"1622";4;9800.00;1
"2692";26903;2215.52;1
"1100";1104;3250.00;1
"3536";35604;454.52;1
"1484";14807;14563.34;1
"1104";1104;3250.00;1
"1619";1;2000.00;1
"1615";3;6600.00;1
"1620";3;7100.00;1
"1601";2;2700.00;1
"1624";2;5000.00;1
"1484";14801;154684.32;1
"1617";1;1800.00;1
"1611";2;3700.00;1
"1604";4;8000.00;1
"1102";1100;3250.00;1
"1101";1101;3250.00;1
"0743";899769;1400.00;1
"1484";14809;18466.58;1
"1609";2;3500.00;1
"7134";321;469.04;1
"5874";700;12000.23;1
"1618";4;9400.00;1
"1324";993005;350.00;1
"2794";27106;11546.15;1
"1621";1;2200.00;1
"0706";993997;100.00;1
"1617";4;9300.00;1
"1619";4;9500.00;1
"1797";197;5361.79;1
"3534";35402;152457.32;1
"1601";3;5200.00;1
"1624";3;7500.00;1
"2692";26902;2316.26;1
"1615";2;4100.00;1
"1620";2;4600.00;1
"1808";195;1040.39;1
"1622";1;2300.00;1
"1608";4;8400.00;1
"1611";3;6200.00;1
"2692";26911;11546.15;1
"1100";1102;3250.00;1
"1621";4;9700.00;1
"1707";1799;498.25;1
"1618";1;1900.00;1
"1304";1;1000000000.00;1
"2692";26905;123.45;1
"1792";199;6303.17;1
*/
	-- (f) Listar o nome dos supervisores juntamente com o número de empregados que eles supervisionam
SELECT s.nome,count(e.*) FROM funcionario s JOIN funcionario e ON s.num_funcional = e.supervisor GROUP BY s.num_funcional;
/*
"Cosme Palha";3
"Caio";1
"Maria Aparecida";2
"Cristiane Dias";1
"Bernardina Pereira";3
"Daniel Dias Alves";1
"Luiz";1
"Cesar Naves";2
"Camila Almeida";3
"Ricardo Filho";1
"Barnabé Cesário";3
"Augusto";4
"Francisco da Silva";2
"Bernardo Vellozo";3
"Johnata Ferreira";1
"Joao da Silva";1
"Alcides Zagalo";3
"Lorenzo Breno Cauê Almeida";4
"Belmira Rodrigues";3
"Paulo Roberto";1
"Apoena Villar";3
"Célia Lobato";3
"Clarisse Espírito Santo";3
"Baltasar Otero";3
"Antonio Oliveira";2
"Thiago Moreira Borges";1
"Jose da Costa";1
"Adélia Barroqueiro";3
"Aluísio Gentil";3
"Anhangüera Silva";3
"Alarico Alancastro";3
"﻿Brenda Melo";4
"Flavia de Almeida";2
"Evandro Santos";2
"Celso Vasconcellos";3
"Lucas Rezende";1
"Caetano Louzada";3
"Aluísio Herrera";3
"Arcidres Fonseca";3
"Adão Casalinho";3
"Arminda Carneiro";3
"Claudemira Villela";3
"Alvito Cachão";3
"Fabricio Ismael";1
"Amílcar Soeiro";3
"Joaquim Nascimento";1
"Maria da Silva";1
"Jose Roberto";1
"Caubi Villar";3
*/		   

-- 20) CONSULTAS COM UNION, INTERSECT, EXCEPT
    -- (a) Listar, em ordem afabética, os nomes de todas as pessoas cadastradas no banco (funcionários, clientes 
	--     e dependentes)
SELECT nome FROM funcionario UNION SELECT nome FROM cliente UNION SELECT nome_dependente FROM dependentes ORDER BY nome;
/*
"Abigail Casalinho"
"Abílio Guedes"
"Acacio Estrella"
"Acacio Vianna"
"Adão Casalinho"
"Adelaide Barroqueiro"
"Adélia Barroqueiro"
"Adelino Benevides"
"Adosindo Alancastro"
"Adriana Santos Farias"
"Aecio Neves"
"Aida Zagalo"
"Ajuricaba Braga"
"Alarico Alancastro"
"Alarico Vieira"
"Alcides Gentil"
"Alcides Zagalo"
"Aleixo Herrera"
"Aleixo Moura"
"Alexandre Pereira"
"Alisson dos Reis"
"Almerinda Villar"
"Aluísio Gentil"
"Aluísio Herrera"
"Aluísio Pessanha"
"Alvito Cachão"
"Amanda Fernandes"
"Amílcar Soeiro"
"Amon Ribeiro Lopes"
"Ana Laura de Almeida"
"Ana Maria Matias"
"Ana Paula Antas"
"Analinda Dutra"
"Anderson Paranaguá"
"André Pais"
"Andres Iniesta"
"Angela Aparecida Silva Siqueira"
"Angelo Alves Ferreira Júnior"
"Anhangüera Silva"
"Aniana Cachão"
"Aniangeles García"
"Aniano Garrau"
"Aníbal Silva"
"Antão Soeiro"
"Antonio Oliveira"
"Apoena Villar"
"Arcidres Fonseca"
"Arda Turan"
"Arminda Carneiro"
"Arthur"
"Arthur Cesar"
"Arthur Reyes"
"Augusta Camacho"
"Augusta Fonseca"
"Augusto"
"Bacary Sagna"
"Baltasar Carneiro"
"Baltasar Marino"
"Baltasar Otero"
"Bárbara Vellozo"
"Barnabé Cesário"
"Belmira Rodrigues"
"Belmiro Prado"
"Bernardete Mourão"
"Bernardina Duarte"
"Bernardina Pereira"
"Bernardino Otero"
"Bernardo Vellozo"
"Blasco Antúnez"
"Blasco Cesário"
"Boaventura Rodrigues"
"Branca Diniz"
"﻿Brenda Melo"
"Bruna Castro"
"Bruna Garcés"
"Bruno Jucá"
"Bruno Lira"
"Bruno Negromonte"
"Bruno Roberto"
"Bukake Jesus"
"Burtira Pereira"
"Caetano Louzada"
"Caio"
"Camila Almeida"
"Capitolina Louzada"
"Carlos"
"Carlos De Souza Novais"
"Carlos Dutra"
"Carlos Eduardo"
"Carlos Henrique De Araujo"
"Carlos Sousa"
"Carmem Campelo"
"Casimiro Mattos"
"Cássia Lima"
"Catarino Almeida"
"Cauã Pinto"
"Caubi Villar"
"Cauê Cintra"
"Cauê Davi Enrico da Silva"
"Cecília Villar"
"Célia Álvarez"
"Célia Anlicoara"
"Célia Lobato"
"Celso Alves"
"Celso Sousa"
"Celso Vasconcellos"
"César De Alencar Sartin"
"Cesar Naves"
"Charles Andrea Comeau"
"Chris Mortágua"
"Christopher Domingos"
"Clarisse Espírito Santo"
"Claudemira Villela"
"Claudio Nascimento"
"Cleber Monforte"
"Cleo Custodio Ferreira"
"Clotilde Ríos"
"Comecus Vasconcellos"
"Cosme Palha"
"Cristiane Dias"
"Cristiano Almeida Silveira"
"Daniel Almeida"
"Daniel Alves"
"Daniel Dias Alves"
"Daniel Morais"
"Daniela De Oliveira Marques"
"Danilo Borges"
"David Desrosiers"
"David Silva"
"Débora Cristina Alves Rita"
"Debora Portela"
"Deise Trindade"
"Delfina Ornelas"
"Délio Candal"
"Délio Grangeia"
"Denise Taperebá"
"Derli Guerra"
"Desirre Tomaz Martins Pereira"
"Diamantino Pozas"
"﻿Diego Castro"
"Diego Gouvêa Couto"
"Diego Rabelo Damasceno"
"Dilma Lana"
"Dinarte Espírito Santo"
"Dinarte Torrado"
"Diodete Figueiredo"
"Diodete Leça"
"Diogo Moita"
"Dom Brites"
"Domingos Antas"
"Dominic Garcez"
"Dorindo Portela"
"Dorindo Villela"
"Douglas"
"Duíllio Tomaz Silva"
"Dulce Chousa"
"Dulce Ferreira"
"Dulce Palha"
"Eden Vilarinho Costa Junior"
"Edgar Frois"
"Eduardo Oliveira"
"Eduardo Palmeira"
"Efraim Ornelas"
"Eládio Ornelas"
"Elba Lobato"
"Eli Paranaguá"
"Eliane Aparecida"
"Elisa Caroline Araújo"
"Eloi Amarante"
"Emília Canejo"
"Emiliano Gracia"
"Emiliano Teixeira Martins"
"Emílio García"
"Emílio Taperebá"
"Énia Leiria "
"Epaminondas Marcondes"
"Ephram Domingos"
"Ernesto Pozas"
"Etiene Borges Silva"
"Eunice Torrado"
"Eva Bulhão"
"Eva Quinterno"
"Evandro Santos"
"Evangelista Antas"
"Ezequiel Portela"
"Fabiano Grangeia"
"Fábio Pamplona"
"Fabricio Ismael"
"Fabrício Mangueira"
"Fabricio Soares Borges"
"Faustino Pedrozo"
"Fausto Brião"
"Felícia Quinzeiro"
"Feliciana Ventura"
"Feliciano Moutinho"
"Feliciano Palmeira"
"Felipe Amaral"
"Fernanda Tavera"
"Fernandinho"
"Fernão Ataí"
"Fernão Butantã"
"Filena Guerra"
"Filena Vilhena"
"Filipa Amarante"
"Flamínia Vega"
"Flavia de Almeida"
"Flávia Meirelles"
"Flávia Pavía"
"Florbela Gracia"
"Floripes Suaçuna"
"Francisco Assis Miguel Jardine"
"Francisco da Silva"
"Frederica Cabreira"
"Frutuoso Suaçuna"
"Gabriel"
"Gabriel Silva De Barros Antunes"
"Gabrielle Barros"
"Gael Clichy"
"Gaspar Tavera"
"Genoveva García"
"Genoveva Uchoa"
"Geraldo Palmeira"
"Gertrudes Marcondes"
"Giovana Quinterno"
"Giselle Brião"
"Gislaine Travassos"
"Gledmar Pires De Moura"
"Gonçalo Carvalhaes"
"Graça Vale"
"Guido Morais"
"Guilherme Antunes"
"Gustavo Dias"
"Harry Toledo"
"Hector Chousa"
"Heitor"
"Heitor Cauã de Paula"
"Hélder Morais"
"Heloisa Juliana da Silva"
"Hiago Cintra"
"Hipólito Quadros"
"Honorina Ventura"
"Horácio Carvalhaes"
"Horácio Quinzeiro"
"Hugo Sosa"
"Igor Motta"
"Ikay Gundogan"
"Ildefonso Castello Branco"
"Ilídio Ataí"
"Ilídio Bernardes"
"Iraci Vilhena"
"Irene Guerrero"
"Isabela Dias"
"Isabella Gontijo"
"Isabelle Pietra Pinto"
"Isilda Prado"
"Isis Cristiane De Camargos Mendes"
"Ivan Rakitic"
"Ivete Rosa"
"Jacinto Garcez"
"Jadir Vega"
"Jair das Couves"
"Jakquelini Taperebá"
"Jamari Meirelles"
"Janaína Paranaguá"
"Jean"
"Jean Francois Stinco"
"Jefferson Moita"
"Jéssica Vega"
"Jéssyca Meirelles"
"Joana Lima"
"Joao da Silva"
"Joao do Pulo"
"Joao Santana"
"Joaquim Nascimento"
"Joe Hart"
"Johnata Ferreira"
"Jonas Augusto"
"Jordan Caminha"
"Jordana Gaspar"
"Jordana Oliveira"
"Jordão Tabalipa"
"Jordi Alba"
"Jorgina Anlicoara"
"Jose da Costa"
"José Marques"
"José Quinterno"
"Jose Roberto"
"Josiane Silva"
"Josino"
"Jule Vilhena"
"Julia Mirella Souza"
"Juliana Amarante"
"Juliano Pamplona"
"Julieta Villas Boas"
"Juliette Valido"
"Julio Igor Cauã Campos"
"Jussara Jucá"
"Kal-El Brites"
"Kárita Mortágua"
"Kauã Naves"
"Kelechi Iheanacho"
"Kevin De Bruyne"
"Kleverson Monforte"
"Lais Sousa Costa"
"Laiza Marie Roldao"
"Lara Juliana Lorena de Paula"
"Laura Luna Oliveira"
"Laura Martins"
"Laura Tavera"
"Lauriane Soares Costa"
"Laurinda Carvalhaes"
"Laurinda Dutra"
"Laurinda Lima"
"Leila Marcondes"
"Lélio Anlicoara"
"Leonor Goncalves"
"Leopoldina Morais"
"Letícia Maria Rosa Lima"
"Liana Travaglia De Sousa"
"Lídia Castello Branco"
"Lidiane Margarida Do Carmo"
"Liedson Domingos"
"Lígia Garcez"
"Lília Paranaguá"
"Liliana Brites"
"Lina Quadros"
"Lineu Mansilla"
"Lino Quadros"
"Lionel Messi"
"Litória Maria Alves De Souza Filha"
"Lopo Vidigal"
"Lorena Alves Silva Ottoni"
"Lorena Fonseca Martins"
"Lorena Pamplona"
"Lorenzo Breno Cauê Almeida"
"Lucas Rezende"
"Ludmilla Vilas Boas Simoneti"
"Luis Inacio"
"Luis Suarez"
"Luiz"
"Luiz Cunha"
"Luiza Flávia Rodrigues"
"Luzia Ferro"
"Magda Fitas"
"Maíra Dutra"
"Mamede Saldaña"
"Marc Andre Ter Stegen"
"Marcelo"
"Marcelo Mangueira"
"Márcia Mangueira"
"Marco Mortágua"
"Marco Reus"
"Maria Aparecida"
"Maria Cavalcanti"
"Maria da Silva"
"Maria Fernanda Ferreira Da Silva"
"Maria Joaquina"
"Mariana Ataí"
"Mariana Oliveira"
"Marilda Toledo"
"Marina Barbosa De Freitas Vieira"
"Marlene Anlicoara"
"Marli Tupinambá"
"Marta Villas Boas"
"Mateus Felipe"
"Matheus Caminha"
"Matheus Dias"
"Matias Travassos"
"Matias Villas Boas"
"﻿Matilde Souza"
"Matt Toledo"
"Matthew Castello Branco"
"Máxima Cotegipe"
"Máxima Reyes"
"Máximo Arantes"
"Melissa Chousa"
"Melissa Jiménez"
"Melissa Lima"
"Mem Domingos"
"Mem Mangueira"
"Micaela Bugallo"
"Micaela Ferrera"
"Miguel Ricardo Costa"
"Miguelina Brites"
"Mileide Mortágua"
"Milu Diegues"
"Minervina Toledo"
"Moaci Chousa"
"Moisés Lira"
"Monalisa Grangeia"
"Nádia Monforte"
"Natalia Araujo"
"Natália Reyes"
"Natália Viveros"
"Nayani Gracia"
"Nazaré Arantes"
"Neide Cavadas"
"Nelson Martínez"
"Neuber Arantes"
"Neuler Reyes"
"Neuza Travassos"
"Neymar Jr"
"Nicolas Breno Luan Moura"
"Nicolas Cavalcanti"
"Nicolas Otamendi"
"Nicolau Travassos"
"Nicole Brenda Barros"
"Nídia Cavadas"
"Nikolas Valido"
"Nilza Freiria"
"Nivaldo Gomes"
"Noémia Cavadas"
"Olavo Negromonte"
"Olga Jucá"
"Ordonho Lira"
"Oriana Monforte"
"Otília Trindade"
"Palmira Garcés"
"Palmira Negromonte"
"Patrícia Travassos"
"Paula Negromonte"
"Paula Siqueira"
"Paulino Brião"
"Paulo Barbosa"
"Paulo Loio"
"Paulo Roberto"
"Paulo Ventura"
"Paulo Victor Machado Prado"
"Pedro"
"Pedro Chousa"
"Pedro Dias"
"Pedro Valido"
"Peri Coito"
"Piedade Garcés"
"Piedade Jucá"
"Piedade Lira"
"Pierre-Emerick Aubameyang"
"Pierre Bouvier"
"Plácido Brião"
"Plínio Moita"
"Potira Caminha"
"Potira Valido"
"Querubim Moita"
"Quintiliana Vieira"
"Quintiliano Malheiro"
"Quintilien Chávez"
"Quitério Tabajara"
"Rafael"
"Rafael Henrique Araujo Dos Reis"
"Rafael Paulino Silva Sobrinho"
"Rafinha"
"Raimundo Caminha"
"Raquel Madureira"
"Raul Varejão"
"Rayane Ferreira Da Silva"
"Renan Calheiros"
"Renato Balladares"
"Renato Garcés"
"Rhaniel"
"Ricardina Soares"
"Ricardo Filho"
"Ricardo Marcelo Mota Filho"
"Ricardo Pozas"
"Roberto Alvarez"
"Rodney Alves"
"Rodolfo Cavadas"
"Rodrigo Francisco De Oliveira"
"Rodrigo Sabrosa"
"Rodrigo Soares Siqueira"
"Roque Alancastre"
"Roquita Ramírez"
"Ruan Moraes Cardoso"
"Rúben Figueroa"
"Rui Lucas"
"Rui Varanda"
"Sabrina Machado"
"Salomé Valentín"
"Sandra Cristina"
"Sandro"
"Sandro Mayrink Paula"
"Santiago Caballero"
"Sarita Taborda"
"Sávio Antunes Maciel Ribeiro"
"Sebastião José"
"Sebastien Lefebvre"
"Sergio Aguero"
"Sheila Arantes"
"Shinji Kagawa"
"Sidônio Mascarenhas"
"Silvana Magallanes"
"Sílvio Hierro"
"Simone Gameiro"
"Socorro Quadros"
"Solange Saldanha"
"Solange Sales"
"Son Goku"
"Sonás Teles"
"Steffan"
"Tadeu Monforte"
"Tainá Villas Boas"
"Talita Vieira Barbosa Martins"
"Tânia Ignacio"
"Tatiana Cristina Silva"
"Teresina Oliveira"
"Teresina Varella"
"Thais Felipe"
"Thiago"
"Thiago Moreira Borges"
"Thiago Nunes"
"Tibúrcio Cirne"
"Tobias Belo"
"Tomás Miguel Rocha"
"Ubaldo Thamily"
"Ubiratã Lucas"
"Ulisses Canejo"
"Valentim Themes"
"Valentina Correia"
"Vanda Tabajara"
"Vanderlei Torrado"
"Vanessa Tavares"
"Verónica Eiró"
"Victor Vinicius De Rezende"
"Vincent Kompany"
"Vitor Borges"
"Wander Quinzeiro"
"Wanessa Danielly Fernandes"
"Willian Alves"
"Wilza Assuncao Braz"
"Xavier Balladares"
"Xavier Vázquez"
"Yaya Toure"
"Zacarias Tupinambá"
"Zoraide Patrício"
*/
	-- (b) Listar, em ordem afabética, os nomes de todas as pessoas cadastradas no banco (funcionários, clientes
	--     e dependentes) incluindo uma coluna nova na resposta que especifica  se a pessoa é cliente,
    --	   funcionário ou dependente.
	--      ex: João  Cliente; Maria Cliente; Zeca Funcionário
	--     a nova coluna deve chamar 'Tipo'. Na resposta, ordenar por tipo e por ordem alfabética de nome
SELECT nome,'Funcionário' as tipo FROM funcionario UNION SELECT nome,'Cliente' FROM cliente UNION SELECT nome_dependente,'Dependente' FROM dependentes ORDER BY tipo,nome;
-- Há nomes repetidos, como há uma coluna diferenciando-os agora, esta consulta apresenta mais resultados do que a consulta anteiror. A consulta anterior não trouxe nomes repetidos.
/*
"Abílio Guedes";"Cliente"
"Acacio Estrella";"Cliente"
"Acacio Vianna";"Cliente"
"Adelino Benevides";"Cliente"
"Adriana Santos Farias";"Cliente"
"Aecio Neves";"Cliente"
"Ajuricaba Braga";"Cliente"
"Alarico Vieira";"Cliente"
"Aleixo Moura";"Cliente"
"Alexandre Pereira";"Cliente"
"Almerinda Villar";"Cliente"
"Aluísio Pessanha";"Cliente"
"Amon Ribeiro Lopes";"Cliente"
"André Pais";"Cliente"
"Andres Iniesta";"Cliente"
"Angela Aparecida Silva Siqueira";"Cliente"
"Angelo Alves Ferreira Júnior";"Cliente"
"Aniano Garrau";"Cliente"
"Arda Turan";"Cliente"
"Arthur Cesar";"Cliente"
"Augusta Camacho";"Cliente"
"Baltasar Marino";"Cliente"
"Belmiro Prado";"Cliente"
"Bernardete Mourão";"Cliente"
"Bernardina Duarte";"Cliente"
"Blasco Antúnez";"Cliente"
"Branca Diniz";"Cliente"
"Bukake Jesus";"Cliente"
"Carlos De Souza Novais";"Cliente"
"Carlos Eduardo";"Cliente"
"Carlos Henrique De Araujo";"Cliente"
"Carmem Campelo";"Cliente"
"Casimiro Mattos";"Cliente"
"Cauã Pinto";"Cliente"
"Cauê Cintra";"Cliente"
"Célia Álvarez";"Cliente"
"Celso Alves";"Cliente"
"Celso Sousa";"Cliente"
"César De Alencar Sartin";"Cliente"
"Charles Andrea Comeau";"Cliente"
"Claudio Nascimento";"Cliente"
"Cleo Custodio Ferreira";"Cliente"
"Clotilde Ríos";"Cliente"
"Cristiano Almeida Silveira";"Cliente"
"Daniel Almeida";"Cliente"
"Daniel Alves";"Cliente"
"Daniela De Oliveira Marques";"Cliente"
"David Desrosiers";"Cliente"
"Débora Cristina Alves Rita";"Cliente"
"Deise Trindade";"Cliente"
"Délio Candal";"Cliente"
"Derli Guerra";"Cliente"
"Desirre Tomaz Martins Pereira";"Cliente"
"Diego Gouvêa Couto";"Cliente"
"Diego Rabelo Damasceno";"Cliente"
"Dilma Lana";"Cliente"
"Diodete Figueiredo";"Cliente"
"Diodete Leça";"Cliente"
"Douglas";"Cliente"
"Duíllio Tomaz Silva";"Cliente"
"Dulce Chousa";"Cliente"
"Dulce Ferreira";"Cliente"
"Eden Vilarinho Costa Junior";"Cliente"
"Edgar Frois";"Cliente"
"Emília Canejo";"Cliente"
"Emiliano Teixeira Martins";"Cliente"
"Etiene Borges Silva";"Cliente"
"Eva Bulhão";"Cliente"
"Fabricio Soares Borges";"Cliente"
"Faustino Pedrozo";"Cliente"
"Feliciano Moutinho";"Cliente"
"Fernão Butantã";"Cliente"
"Filena Guerra";"Cliente"
"Flávia Pavía";"Cliente"
"Floripes Suaçuna";"Cliente"
"Francisco Assis Miguel Jardine";"Cliente"
"Frederica Cabreira";"Cliente"
"Frutuoso Suaçuna";"Cliente"
"Gabriel Silva De Barros Antunes";"Cliente"
"Genoveva Uchoa";"Cliente"
"Gledmar Pires De Moura";"Cliente"
"Graça Vale";"Cliente"
"Guilherme Antunes";"Cliente"
"Heitor";"Cliente"
"Heitor Cauã de Paula";"Cliente"
"Hélder Morais";"Cliente"
"Hugo Sosa";"Cliente"
"Ilídio Bernardes";"Cliente"
"Irene Guerrero";"Cliente"
"Isabela Dias";"Cliente"
"Isabella Gontijo";"Cliente"
"Isabelle Pietra Pinto";"Cliente"
"Isilda Prado";"Cliente"
"Isis Cristiane De Camargos Mendes";"Cliente"
"Ivan Rakitic";"Cliente"
"Ivete Rosa";"Cliente"
"Jean Francois Stinco";"Cliente"
"Joao Santana";"Cliente"
"Jordana Gaspar";"Cliente"
"Jordana Oliveira";"Cliente"
"Jordão Tabalipa";"Cliente"
"Jordi Alba";"Cliente"
"José Marques";"Cliente"
"Lais Sousa Costa";"Cliente"
"Laiza Marie Roldao";"Cliente"
"Laura Luna Oliveira";"Cliente"
"Lauriane Soares Costa";"Cliente"
"Letícia Maria Rosa Lima";"Cliente"
"Liana Travaglia De Sousa";"Cliente"
"Lidiane Margarida Do Carmo";"Cliente"
"Lineu Mansilla";"Cliente"
"Litória Maria Alves De Souza Filha";"Cliente"
"Lopo Vidigal";"Cliente"
"Lorena Alves Silva Ottoni";"Cliente"
"Lorena Fonseca Martins";"Cliente"
"Ludmilla Vilas Boas Simoneti";"Cliente"
"Luis Inacio";"Cliente"
"Luis Suarez";"Cliente"
"Luiz";"Cliente"
"Luiza Flávia Rodrigues";"Cliente"
"Luzia Ferro";"Cliente"
"Magda Fitas";"Cliente"
"Mamede Saldaña";"Cliente"
"Marc Andre Ter Stegen";"Cliente"
"Marcelo";"Cliente"
"Marco Reus";"Cliente"
"Maria Fernanda Ferreira Da Silva";"Cliente"
"Maria Joaquina";"Cliente"
"Marina Barbosa De Freitas Vieira";"Cliente"
"Marli Tupinambá";"Cliente"
"Matias Travassos";"Cliente"
"﻿Matilde Souza";"Cliente"
"Máxima Cotegipe";"Cliente"
"Melissa Jiménez";"Cliente"
"Micaela Bugallo";"Cliente"
"Micaela Ferrera";"Cliente"
"Milu Diegues";"Cliente"
"Natália Viveros";"Cliente"
"Nelson Martínez";"Cliente"
"Neymar Jr";"Cliente"
"Nicolas Cavalcanti";"Cliente"
"Nilza Freiria";"Cliente"
"Nivaldo Gomes";"Cliente"
"Otília Trindade";"Cliente"
"Paulo Loio";"Cliente"
"Paulo Victor Machado Prado";"Cliente"
"Pedro";"Cliente"
"Peri Coito";"Cliente"
"Pierre-Emerick Aubameyang";"Cliente"
"Pierre Bouvier";"Cliente"
"Quintiliana Vieira";"Cliente"
"Quintiliano Malheiro";"Cliente"
"Quintilien Chávez";"Cliente"
"Rafael Henrique Araujo Dos Reis";"Cliente"
"Rafael Paulino Silva Sobrinho";"Cliente"
"Rafinha";"Cliente"
"Raquel Madureira";"Cliente"
"Raul Varejão";"Cliente"
"Rayane Ferreira Da Silva";"Cliente"
"Renan Calheiros";"Cliente"
"Renato Balladares";"Cliente"
"Ricardo Marcelo Mota Filho";"Cliente"
"Rodrigo Francisco De Oliveira";"Cliente"
"Rodrigo Sabrosa";"Cliente"
"Rodrigo Soares Siqueira";"Cliente"
"Roquita Ramírez";"Cliente"
"Ruan Moraes Cardoso";"Cliente"
"Rui Varanda";"Cliente"
"Sabrina Machado";"Cliente"
"Sandra Cristina";"Cliente"
"Sandro Mayrink Paula";"Cliente"
"Sávio Antunes Maciel Ribeiro";"Cliente"
"Sebastien Lefebvre";"Cliente"
"Shinji Kagawa";"Cliente"
"Sidônio Mascarenhas";"Cliente"
"Simone Gameiro";"Cliente"
"Solange Saldanha";"Cliente"
"Solange Sales";"Cliente"
"Son Goku";"Cliente"
"Steffan";"Cliente"
"Talita Vieira Barbosa Martins";"Cliente"
"Tânia Ignacio";"Cliente"
"Tatiana Cristina Silva";"Cliente"
"Teresina Oliveira";"Cliente"
"Thais Felipe";"Cliente"
"Tibúrcio Cirne";"Cliente"
"Tobias Belo";"Cliente"
"Tomás Miguel Rocha";"Cliente"
"Valentina Correia";"Cliente"
"Victor Vinicius De Rezende";"Cliente"
"Vitor Borges";"Cliente"
"Wanessa Danielly Fernandes";"Cliente"
"Wilza Assuncao Braz";"Cliente"
"Abigail Casalinho";"Dependente"
"Adelaide Barroqueiro";"Dependente"
"Adosindo Alancastro";"Dependente"
"Aida Zagalo";"Dependente"
"Alcides Gentil";"Dependente"
"Aleixo Herrera";"Dependente"
"Amanda Fernandes";"Dependente"
"Ana Laura de Almeida";"Dependente"
"Ana Paula Antas";"Dependente"
"Analinda Dutra";"Dependente"
"Anderson Paranaguá";"Dependente"
"Aniana Cachão";"Dependente"
"Aniangeles García";"Dependente"
"Aníbal Silva";"Dependente"
"Antão Soeiro";"Dependente"
"Apoena Villar";"Dependente"
"Arthur Reyes";"Dependente"
"Augusta Fonseca";"Dependente"
"Bacary Sagna";"Dependente"
"Baltasar Carneiro";"Dependente"
"Bárbara Vellozo";"Dependente"
"Bernardino Otero";"Dependente"
"Blasco Cesário";"Dependente"
"Boaventura Rodrigues";"Dependente"
"Bruna Garcés";"Dependente"
"Bruno Jucá";"Dependente"
"Bruno Lira";"Dependente"
"Bruno Negromonte";"Dependente"
"Bruno Roberto";"Dependente"
"Burtira Pereira";"Dependente"
"Caio";"Dependente"
"Camila Almeida";"Dependente"
"Capitolina Louzada";"Dependente"
"Carlos Dutra";"Dependente"
"Carlos Eduardo";"Dependente"
"Cássia Lima";"Dependente"
"Catarino Almeida";"Dependente"
"Cecília Villar";"Dependente"
"Célia Anlicoara";"Dependente"
"Chris Mortágua";"Dependente"
"Christopher Domingos";"Dependente"
"Cleber Monforte";"Dependente"
"Comecus Vasconcellos";"Dependente"
"Daniel Morais";"Dependente"
"Danilo Borges";"Dependente"
"David Silva";"Dependente"
"Debora Portela";"Dependente"
"﻿Diego Castro";"Dependente"
"Dinarte Espírito Santo";"Dependente"
"Diogo Moita";"Dependente"
"Dom Brites";"Dependente"
"Dominic Garcez";"Dependente"
"Dorindo Villela";"Dependente"
"Dulce Palha";"Dependente"
"Efraim Ornelas";"Dependente"
"Eládio Ornelas";"Dependente"
"Elba Lobato";"Dependente"
"Eli Paranaguá";"Dependente"
"Eliane Aparecida";"Dependente"
"Elisa Caroline Araújo";"Dependente"
"Emílio Taperebá";"Dependente"
"Ephram Domingos";"Dependente"
"Ernesto Pozas";"Dependente"
"Eunice Torrado";"Dependente"
"Evangelista Antas";"Dependente"
"Ezequiel Portela";"Dependente"
"Fabiano Grangeia";"Dependente"
"Fabrício Mangueira";"Dependente"
"Fausto Brião";"Dependente"
"Feliciano Palmeira";"Dependente"
"Felipe Amaral";"Dependente"
"Fernanda Tavera";"Dependente"
"Fernandinho";"Dependente"
"Filipa Amarante";"Dependente"
"Florbela Gracia";"Dependente"
"Gabriel";"Dependente"
"Gabrielle Barros";"Dependente"
"Gael Clichy";"Dependente"
"Genoveva García";"Dependente"
"Geraldo Palmeira";"Dependente"
"Gertrudes Marcondes";"Dependente"
"Giovana Quinterno";"Dependente"
"Giselle Brião";"Dependente"
"Gislaine Travassos";"Dependente"
"Harry Toledo";"Dependente"
"Hector Chousa";"Dependente"
"Heloisa Juliana da Silva";"Dependente"
"Honorina Ventura";"Dependente"
"Horácio Carvalhaes";"Dependente"
"Horácio Quinzeiro";"Dependente"
"Igor Motta";"Dependente"
"Ikay Gundogan";"Dependente"
"Ilídio Ataí";"Dependente"
"Iraci Vilhena";"Dependente"
"Jadir Vega";"Dependente"
"Jakquelini Taperebá";"Dependente"
"Jamari Meirelles";"Dependente"
"Jefferson Moita";"Dependente"
"Jéssica Vega";"Dependente"
"Jéssyca Meirelles";"Dependente"
"Joana Lima";"Dependente"
"Joao do Pulo";"Dependente"
"Joe Hart";"Dependente"
"Jonas Augusto";"Dependente"
"Jordan Caminha";"Dependente"
"José Quinterno";"Dependente"
"Josino";"Dependente"
"Jule Vilhena";"Dependente"
"Julia Mirella Souza";"Dependente"
"Juliana Amarante";"Dependente"
"Juliano Pamplona";"Dependente"
"Juliette Valido";"Dependente"
"Jussara Jucá";"Dependente"
"Kal-El Brites";"Dependente"
"Kárita Mortágua";"Dependente"
"Kauã Naves";"Dependente"
"Kelechi Iheanacho";"Dependente"
"Kevin De Bruyne";"Dependente"
"Kleverson Monforte";"Dependente"
"Lara Juliana Lorena de Paula";"Dependente"
"Laura Martins";"Dependente"
"Laura Tavera";"Dependente"
"Laurinda Carvalhaes";"Dependente"
"Leila Marcondes";"Dependente"
"Lélio Anlicoara";"Dependente"
"Leopoldina Morais";"Dependente"
"Lídia Castello Branco";"Dependente"
"Lígia Garcez";"Dependente"
"Lília Paranaguá";"Dependente"
"Lina Quadros";"Dependente"
"Lino Quadros";"Dependente"
"Lorena Pamplona";"Dependente"
"Maíra Dutra";"Dependente"
"Marcelo Mangueira";"Dependente"
"Márcia Mangueira";"Dependente"
"Maria Cavalcanti";"Dependente"
"Mariana Ataí";"Dependente"
"Mariana Oliveira";"Dependente"
"Marlene Anlicoara";"Dependente"
"Marta Villas Boas";"Dependente"
"Mateus Felipe";"Dependente"
"Matheus Caminha";"Dependente"
"Matheus Dias";"Dependente"
"Matias Villas Boas";"Dependente"
"Matt Toledo";"Dependente"
"Matthew Castello Branco";"Dependente"
"Máxima Reyes";"Dependente"
"Máximo Arantes";"Dependente"
"Melissa Lima";"Dependente"
"Mem Domingos";"Dependente"
"Miguelina Brites";"Dependente"
"Mileide Mortágua";"Dependente"
"Minervina Toledo";"Dependente"
"Moaci Chousa";"Dependente"
"Moisés Lira";"Dependente"
"Monalisa Grangeia";"Dependente"
"Nayani Gracia";"Dependente"
"Neide Cavadas";"Dependente"
"Neuber Arantes";"Dependente"
"Neuler Reyes";"Dependente"
"Neuza Travassos";"Dependente"
"Nicolas Otamendi";"Dependente"
"Nicole Brenda Barros";"Dependente"
"Nídia Cavadas";"Dependente"
"Nikolas Valido";"Dependente"
"Oriana Monforte";"Dependente"
"Palmira Negromonte";"Dependente"
"Patrícia Travassos";"Dependente"
"Paula Negromonte";"Dependente"
"Paula Siqueira";"Dependente"
"Paulo Ventura";"Dependente"
"Pedro Chousa";"Dependente"
"Pedro Dias";"Dependente"
"Piedade Garcés";"Dependente"
"Piedade Jucá";"Dependente"
"Piedade Lira";"Dependente"
"Plácido Brião";"Dependente"
"Potira Valido";"Dependente"
"Querubim Moita";"Dependente"
"Rafael";"Dependente"
"Raimundo Caminha";"Dependente"
"Renato Garcés";"Dependente"
"Ricardo Pozas";"Dependente"
"Roberto Alvarez";"Dependente"
"Rodney Alves";"Dependente"
"Rodolfo Cavadas";"Dependente"
"Sergio Aguero";"Dependente"
"Sheila Arantes";"Dependente"
"Tainá Villas Boas";"Dependente"
"Thiago";"Dependente"
"Vanderlei Torrado";"Dependente"
"Vanessa Tavares";"Dependente"
"Vincent Kompany";"Dependente"
"Wander Quinzeiro";"Dependente"
"Willian Alves";"Dependente"
"Yaya Toure";"Dependente"
"Adão Casalinho";"Funcionário"
"Adélia Barroqueiro";"Funcionário"
"Alarico Alancastro";"Funcionário"
"Alcides Zagalo";"Funcionário"
"Alisson dos Reis";"Funcionário"
"Aluísio Gentil";"Funcionário"
"Aluísio Herrera";"Funcionário"
"Alvito Cachão";"Funcionário"
"Amílcar Soeiro";"Funcionário"
"Ana Maria Matias";"Funcionário"
"Anhangüera Silva";"Funcionário"
"Antonio Oliveira";"Funcionário"
"Apoena Villar";"Funcionário"
"Arcidres Fonseca";"Funcionário"
"Arminda Carneiro";"Funcionário"
"Arthur";"Funcionário"
"Augusto";"Funcionário"
"Baltasar Otero";"Funcionário"
"Barnabé Cesário";"Funcionário"
"Belmira Rodrigues";"Funcionário"
"Bernardina Pereira";"Funcionário"
"Bernardo Vellozo";"Funcionário"
"﻿Brenda Melo";"Funcionário"
"Bruna Castro";"Funcionário"
"Caetano Louzada";"Funcionário"
"Caio";"Funcionário"
"Camila Almeida";"Funcionário"
"Carlos";"Funcionário"
"Carlos Sousa";"Funcionário"
"Caubi Villar";"Funcionário"
"Cauê Davi Enrico da Silva";"Funcionário"
"Célia Lobato";"Funcionário"
"Celso Vasconcellos";"Funcionário"
"Cesar Naves";"Funcionário"
"Clarisse Espírito Santo";"Funcionário"
"Claudemira Villela";"Funcionário"
"Cosme Palha";"Funcionário"
"Cristiane Dias";"Funcionário"
"Daniel Dias Alves";"Funcionário"
"Delfina Ornelas";"Funcionário"
"Délio Grangeia";"Funcionário"
"Denise Taperebá";"Funcionário"
"Diamantino Pozas";"Funcionário"
"Dinarte Torrado";"Funcionário"
"Domingos Antas";"Funcionário"
"Dorindo Portela";"Funcionário"
"Eduardo Oliveira";"Funcionário"
"Eduardo Palmeira";"Funcionário"
"Eloi Amarante";"Funcionário"
"Emiliano Gracia";"Funcionário"
"Emílio García";"Funcionário"
"Énia Leiria ";"Funcionário"
"Epaminondas Marcondes";"Funcionário"
"Eva Quinterno";"Funcionário"
"Evandro Santos";"Funcionário"
"Fábio Pamplona";"Funcionário"
"Fabricio Ismael";"Funcionário"
"Felícia Quinzeiro";"Funcionário"
"Feliciana Ventura";"Funcionário"
"Fernão Ataí";"Funcionário"
"Filena Vilhena";"Funcionário"
"Flamínia Vega";"Funcionário"
"Flavia de Almeida";"Funcionário"
"Flávia Meirelles";"Funcionário"
"Francisco da Silva";"Funcionário"
"Gaspar Tavera";"Funcionário"
"Gonçalo Carvalhaes";"Funcionário"
"Guido Morais";"Funcionário"
"Gustavo Dias";"Funcionário"
"Hiago Cintra";"Funcionário"
"Hipólito Quadros";"Funcionário"
"Ildefonso Castello Branco";"Funcionário"
"Jacinto Garcez";"Funcionário"
"Jair das Couves";"Funcionário"
"Janaína Paranaguá";"Funcionário"
"Jean";"Funcionário"
"Joao da Silva";"Funcionário"
"Joaquim Nascimento";"Funcionário"
"Johnata Ferreira";"Funcionário"
"Jorgina Anlicoara";"Funcionário"
"Jose da Costa";"Funcionário"
"Jose Roberto";"Funcionário"
"Josiane Silva";"Funcionário"
"Julieta Villas Boas";"Funcionário"
"Julio Igor Cauã Campos";"Funcionário"
"Laurinda Dutra";"Funcionário"
"Laurinda Lima";"Funcionário"
"Leonor Goncalves";"Funcionário"
"Liedson Domingos";"Funcionário"
"Liliana Brites";"Funcionário"
"Lionel Messi";"Funcionário"
"Lorenzo Breno Cauê Almeida";"Funcionário"
"Lucas Rezende";"Funcionário"
"Luiz";"Funcionário"
"Luiz Cunha";"Funcionário"
"Marco Mortágua";"Funcionário"
"Maria Aparecida";"Funcionário"
"Maria da Silva";"Funcionário"
"Marilda Toledo";"Funcionário"
"Melissa Chousa";"Funcionário"
"Mem Mangueira";"Funcionário"
"Miguel Ricardo Costa";"Funcionário"
"Nádia Monforte";"Funcionário"
"Natalia Araujo";"Funcionário"
"Natália Reyes";"Funcionário"
"Nazaré Arantes";"Funcionário"
"Nicolas Breno Luan Moura";"Funcionário"
"Nicolau Travassos";"Funcionário"
"Noémia Cavadas";"Funcionário"
"Olavo Negromonte";"Funcionário"
"Olga Jucá";"Funcionário"
"Ordonho Lira";"Funcionário"
"Palmira Garcés";"Funcionário"
"Paulino Brião";"Funcionário"
"Paulo Barbosa";"Funcionário"
"Paulo Roberto";"Funcionário"
"Pedro Valido";"Funcionário"
"Plínio Moita";"Funcionário"
"Potira Caminha";"Funcionário"
"Quitério Tabajara";"Funcionário"
"Rafael";"Funcionário"
"Rhaniel";"Funcionário"
"Ricardina Soares";"Funcionário"
"Ricardo Filho";"Funcionário"
"Roque Alancastre";"Funcionário"
"Rúben Figueroa";"Funcionário"
"Rui Lucas";"Funcionário"
"Salomé Valentín";"Funcionário"
"Sandro";"Funcionário"
"Santiago Caballero";"Funcionário"
"Sarita Taborda";"Funcionário"
"Sebastião José";"Funcionário"
"Silvana Magallanes";"Funcionário"
"Sílvio Hierro";"Funcionário"
"Socorro Quadros";"Funcionário"
"Sonás Teles";"Funcionário"
"Tadeu Monforte";"Funcionário"
"Teresina Varella";"Funcionário"
"Thiago Moreira Borges";"Funcionário"
"Thiago Nunes";"Funcionário"
"Ubaldo Thamily";"Funcionário"
"Ubiratã Lucas";"Funcionário"
"Ulisses Canejo";"Funcionário"
"Valentim Themes";"Funcionário"
"Vanda Tabajara";"Funcionário"
"Verónica Eiró";"Funcionário"
"Xavier Balladares";"Funcionário"
"Xavier Vázquez";"Funcionário"
"Zacarias Tupinambá";"Funcionário"
"Zoraide Patrício";"Funcionário"
*/
	-- (c) Mostrar os estados que possuem agências mas não possuem clientes que nasceram antes de '01/01/1995'
select estado from agencia group by estado except select a.estado from agencia a inner join clienteconta cc on a.codigo = cc.cod_agencia inner join cliente c on cc.id_cliente = c.id where c.data_nasc < '01/01/1995'
--Nenhum resultado
	-- (d) Mostrar os nomes repetidos de clientes e funcionários	
SELECT nome FROM cliente INTERSECT SELECT nome FROM funcionario;
/*
"Luiz"
*/
	-- (e) Mostrar os nomes repetidos de clientes e dependentes
SELECT nome FROM cliente INTERSECT SELECT nome_dependente FROM dependentes;
/*
"Carlos Eduardo"
*/
	-- (f) Mostrar os nomes repetidos de clientes, funcionários e dependentes
select nome from cliente intersect select nome_dependente from dependentes intersect select nome from funcionario
--Não há nome que se repete nos 3 tipos de pessoa
	-- (g) Mostrar os nomes repetidos de clientes e dependentes e de clientes e dependentes
SELECT nome FROM cliente INTERSECT SELECT nome_dependente FROM dependentes;
/*
"Carlos Eduardo"
*/
	-- (h) Mostrar o número funcional dos funcionários que são supervisores mas não são gerentes
SELECT DISTINCT s.num_funcional FROM funcionario s JOIN funcionario f ON s.num_funcional = f.supervisor INTERSECT SELECT g.num_funcional FROM funcionario g WHERE g.num_funcional NOT IN (SELECT gerente FROM cliente);
/*
100
*/
	-- (i) Mostrar o nome dos funcionários que são supervisores mas não são gerentes
SELECT nome FROM funcionario WHERE num_funcional IN (SELECT DISTINCT s.num_funcional FROM funcionario s JOIN funcionario f ON s.num_funcional = f.supervisor INTERSECT SELECT g.num_funcional FROM funcionario g WHERE g.num_funcional NOT IN (SELECT gerente FROM cliente));
/*
"﻿Brenda Melo"
*/
	-- (j) Mostrar as agências (o código) que possuem funcionários mas não possuem contas
select distinct agencia from funcionario intersect select codigo from agencia where codigo not in (select cod_agencia from clienteconta)
-- Nenhum caso. A única agência sem conta é a 3139 mas ela também não tem funcionário
	-- (k) Mostrar as agências (o código) que possuem contas mas não possuem funcionarios
select distinct cod_agencia from clienteconta intersect select codigo from agencia where codigo not in (select agencia from funcionario)
-- Nenhum caso. A única agência sem funcionário é a 3139 mas ela também não tem conta
	-- (l) Mostrar as agências (o código) que não possuem contas nem funcionários
(select codigo from agencia where codigo not in (select cod_agencia from clienteconta)) intersect (select codigo from agencia where codigo not in (select agencia from funcionario))
/*
"3139"
*/